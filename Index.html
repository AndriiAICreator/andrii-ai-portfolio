<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Andrii - AI Creator | Professional AI Services</title>
    <meta name="description" content="Professional AI services: avatars, voiceover, image and video generation, e-commerce creatives, virtual photoshoots">
    
    <!-- Favicon - Robot Icon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><circle cx='50' cy='50' r='45' fill='%23ffffff'/><circle cx='50' cy='50' r='40' fill='%232563eb'/><rect x='35' y='35' width='8' height='8' rx='2' fill='%23ffffff'/><rect x='57' y='35' width='8' height='8' rx='2' fill='%23ffffff'/><rect x='40' y='55' width='20' height='6' rx='3' fill='%23ffffff'/><rect x='30' y='20' width='6' height='15' rx='3' fill='%232563eb'/><rect x='64' y='20' width='6' height='15' rx='3' fill='%232563eb'/></svg>">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><circle cx='50' cy='50' r='45' fill='%23ffffff'/><circle cx='50' cy='50' r='40' fill='%232563eb'/><rect x='35' y='35' width='8' height='8' rx='2' fill='%23ffffff'/><rect x='57' y='35' width='8' height='8' rx='2' fill='%23ffffff'/><rect x='40' y='55' width='20' height='6' rx='3' fill='%23ffffff'/><rect x='30' y='20' width='6' height='15' rx='3' fill='%232563eb'/></svg>">
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" xintegrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer">
    
    <style>
        body { 
            font-family: 'Inter', sans-serif; 
            background: radial-gradient(ellipse at top, #1e1b4b 0%, #0f0f23 50%, #000000 100%);
            color: #ffffff;
            overflow-x: hidden;
        }
        
        .gradient-bg { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            position: relative;
            overflow: hidden;
            width: 100%;
            max-width: 100vw;
        }

        .epic-card {
            background: linear-gradient(145deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 0 25px 50px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.3);
            contain: layout style;
        }
        
        .service-card:hover { 
            transform: translateY(-20px) scale(1.05);
            box-shadow: 0 50px 100px rgba(139, 92, 246, 0.3), 0 0 50px rgba(139, 92, 246, 0.2);
            border-color: rgba(139, 92, 246, 0.5);
        }
        
        .floating { animation: floating 6s ease-in-out infinite; }
        @keyframes floating {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-30px) rotate(0deg); }
        }

        .admin-panel { display: none; }
        .admin-mode .admin-panel { display: block; }
        .admin-mode .admin-only { display: block !important; }
        .admin-only { display: none; }
        .portfolio-item { position: relative; }
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.7); z-index: 100; }
        .modal.active { display: flex; align-items: center; justify-content: center; }
        .notification { position: fixed; top: 20px; right: 20px; z-index: 200; padding: 12px 24px; border-radius: 8px; color: white; font-weight: 500; transform: translateX(400px); transition: transform 0.3s ease; }
        .notification.show { transform: translateX(0); }
        .notification.success { background: #10b981; }
        .notification.error { background: #ef4444; }
        
        /* Portfolio Grid - Masonry Layout */
        .portfolio-grid {
            columns: 3;
            column-gap: 2rem;
        }
        
        .portfolio-item {
            display: inline-block;
            width: 100%;
            margin-bottom: 2rem;
            break-inside: avoid;
            background: linear-gradient(145deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 24px;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
        }
        
        .portfolio-item:hover {
            transform: translateY(-15px) scale(1.03);
            box-shadow: 0 40px 80px rgba(139, 92, 246, 0.4), 0 0 40px rgba(139, 92, 246, 0.3);
            border-color: rgba(139, 92, 246, 0.6);
            z-index: 10;
        }
        
        @keyframes portfolioFadeIn {
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
        
        /* Responsive Masonry */
        @media (max-width: 1200px) { .portfolio-grid { columns: 2; column-gap: 1.5rem; } }
        @media (max-width: 768px) { .portfolio-grid { columns: 1; column-gap: 0; } }
        
        /* Lightbox Styles */
        .lightbox { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 300; padding: 20px; }
        .lightbox.active { display: flex; align-items: center; justify-content: center; }
        .lightbox-content { max-width: 90vw; max-height: 90vh; position: relative; }
        .lightbox-nav { position: fixed; top: 50%; transform: translateY(-50%); background: rgba(0,0,0,0.7); color: white; border: 2px solid rgba(255,255,255,0.3); width: 60px; height: 60px; border-radius: 50%; cursor: pointer; font-size: 24px; z-index: 310; display: flex; align-items: center; justify-content: center; transition: all 0.3s ease; }
        .lightbox-nav:hover { background: rgba(255,255,255,0.2); border-color: rgba(255,255,255,0.6); transform: translateY(-50%) scale(1.1); }
        .lightbox-prev { left: 30px; }
        .lightbox-next { right: 30px; }
        .lightbox-close { position: fixed; top: 30px; right: 30px; background: rgba(0,0,0,0.7); color: white; border: 2px solid rgba(255,255,255,0.3); border-radius: 50%; width: 50px; height: 50px; font-size: 24px; cursor: pointer; z-index: 310; display: flex; align-items: center; justify-content: center; transition: all 0.3s ease; }
        .lightbox-close:hover { color: #ff4444; background: rgba(255,68,68,0.2); border-color: #ff4444; transform: scale(1.1); }
        .lightbox-counter { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.7); color: white; padding: 8px 16px; border-radius: 20px; font-size: 14px; z-index: 310; }
        
        html { scroll-behavior: smooth; }
        
        .api-status { position: fixed; top: 80px; left: 20px; z-index: 50; padding: 8px 12px; border-radius: 20px; font-size: 12px; font-weight: 500; transition: all 0.3s ease; display: none; }
        .admin-mode .api-status { display: block; }
        .api-status.online { background: #10b981; color: white; }
        .api-status.offline { background: #ef4444; color: white; }
        .api-status.loading { background: #f59e0b; color: white; }
    </style>
</head>

<body class="bg-gray-900">
    <!-- UI Elements (Modals, Nav, etc.) -->
    <div id="api-status" class="api-status loading"><i class="fas fa-cloud"></i> Connecting...</div>
    <div id="admin-login" class="fixed bottom-2 right-2 z-50"> <button id="admin-toggle" class="bg-gray-900/50 text-gray-500 p-1 rounded text-xs hover:bg-gray-700 hover:text-white transition-all duration-300 opacity-30 hover:opacity-100">‚öô</button> </div>
    <div id="admin-panel" class="admin-panel fixed bottom-12 right-2 bg-gray-800 text-white rounded-lg shadow-lg p-4 z-40 max-w-sm border border-gray-600"> <h3 class="font-bold mb-4 text-white">üõ†Ô∏è Admin Panel</h3> <div class="space-y-2"> <button onclick="openPortfolioModal()" class="w-full bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600">Add Portfolio Item</button> <button onclick="openTechModal()" class="w-full bg-purple-500 text-white px-4 py-2 rounded-lg hover:bg-purple-600">Manage Technologies</button> <button onclick="openContactModal()" class="w-full bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600">Manage Contacts</button> </div> </div>
    <div id="portfolio-modal" class="modal"> <div class="bg-gray-800 text-white rounded-lg p-6 max-w-md w-full mx-4 border border-gray-600"> <h3 class="text-xl font-bold mb-4">üìÅ Add Portfolio Item</h3> <form id="portfolio-form" class="space-y-4"> <div> <label>Category</label> <select id="portfolio-category" class="w-full px-3 py-2 bg-gray-700 rounded-lg" required> <option value="avatars">AI Avatars</option> <option value="image-generation">Image Generation</option> <option value="video-creation">Video Creation</option> <option value="ecommerce">E-commerce</option> <option value="virtual-shoots">Virtual Shoots</option> </select> </div> <div> <label>Media Type</label> <select id="portfolio-media-type" class="w-full px-3 py-2 bg-gray-700 rounded-lg" required> <option value="photo">üì∏ Photo</option> <option value="video">üé¨ Video</option> </select> </div> <div> <label>File/URL</label> <input type="text" id="portfolio-url" class="w-full px-3 py-2 bg-gray-700 rounded-lg" placeholder="YouTube, Dropbox, or direct URL"> <label class="mt-2 inline-block">Or upload file:</label> <input type="file" id="portfolio-file" class="w-full bg-gray-700 rounded-lg text-sm"> </div> <div class="flex gap-2"> <button type="submit" class="flex-1 bg-blue-500 py-2 rounded-lg">Add</button> <button type="button" onclick="closePortfolioModal()" class="flex-1 bg-gray-600 py-2 rounded-lg">Cancel</button> </div> </form> </div> </div>
    <div id="tech-modal" class="modal"></div>
    <div id="contact-modal" class="modal"></div>
    <div id="password-modal" class="modal"> <div class="bg-gray-800 text-white rounded-lg p-6 max-w-sm w-full mx-4"> <h3 class="text-xl font-bold mb-4">üîê Admin Access</h3> <form id="password-form" class="space-y-4"> <input type="password" id="admin-password" class="w-full px-3 py-2 bg-gray-700 rounded-lg" required> <div class="flex gap-2"> <button type="submit" class="flex-1 bg-blue-500 py-2 rounded-lg">Login</button> <button type="button" onclick="closePasswordModal()" class="flex-1 bg-gray-600 py-2 rounded-lg">Cancel</button> </div> </form> </div> </div>
    <nav class="bg-black/80 backdrop-filter backdrop-blur-lg border-b border-purple-500/30 shadow-2xl fixed w-full top-0 z-40"> <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"> <div class="flex justify-between items-center h-16"> <div class="font-bold text-2xl bg-gradient-to-r from-purple-400 to-pink-500 bg-clip-text text-transparent">‚ú® Andrii AI</div> <div class="hidden md:flex space-x-8"> <a href="#about" class="text-gray-300 hover:text-cyan-400">About</a> <a href="#services" class="text-gray-300 hover:text-purple-400">Services</a> <a href="#portfolio" class="text-gray-300 hover:text-pink-400">Portfolio</a> <a href="#contact" class="text-gray-300 hover:text-green-400">Contact</a> </div> </div> </div> </nav>

    <!-- Page Content -->
    <main>
        <section class="gradient-bg text-white py-20 mt-16 relative min-h-screen flex items-center">
             <!-- Hero content -->
        </section>

        <section id="portfolio" class="py-20 bg-gradient-to-b from-gray-900 to-black relative">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center mb-16">
                    <h2 class="text-4xl md:text-6xl font-bold mb-6 bg-gradient-to-r from-yellow-400 via-orange-500 to-red-500 bg-clip-text text-transparent">Portfolio</h2>
                    <p class="text-xl text-gray-300">Examples of my work</p>
                </div>
                <div class="flex flex-wrap justify-center gap-4 mb-8">
                    <button class="portfolio-filter active px-6 py-3 rounded-full bg-gradient-to-r from-purple-500 to-pink-500 text-white" data-filter="all">All</button>
                    <button class="portfolio-filter px-6 py-3 rounded-full bg-gray-800 text-gray-300 border-2 border-gray-600" data-filter="photos">üì∏ Photos</button>
                    <button class="portfolio-filter px-6 py-3 rounded-full bg-gray-800 text-gray-300 border-2 border-gray-600" data-filter="videos">üé¨ Videos</button>
                </div>
                <div id="category-filter" class="flex justify-center gap-2 mb-12">
                    <select id="category-select" class="px-4 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white">
                        <option value="all">All Categories</option>
                        <option value="avatars">AI Avatars</option>
                        <option value="image-generation">Image Generation</option>
                        <option value="video-creation">Video Creation</option>
                        <option value="ecommerce">E-commerce</option>
                        <option value="virtual-shoots">Virtual Shoots</option>
                    </select>
                </div>
                <div id="portfolio-grid" class="portfolio-grid"></div>
                <div class="text-center mt-12" id="load-more-container" style="display: none;">
                    <button id="load-more-btn" class="epic-card px-8 py-4 rounded-full font-bold">Load More</button>
                </div>
            </div>
        </section>
        
        <!-- Other sections like About, Services, Contact -->
    </main>

    <!-- Lightbox -->
    <div id="lightbox" class="lightbox"> <div id="lightbox-content" class="lightbox-content"></div> <button id="lightbox-prev" class="lightbox-nav lightbox-prev"><i class="fas fa-chevron-left"></i></button> <button id="lightbox-next" class="lightbox-nav lightbox-next"><i class="fas fa-chevron-right"></i></button> <button id="lightbox-close" class="lightbox-close"><i class="fas fa-times"></i></button> <div id="lightbox-counter" class="lightbox-counter"></div> </div>
    <div id="notification" class="notification"></div>
    <div class="mouse-trail" id="mouseTrail"></div>

    <script type="module">
        // --- CONFIGURATION ---
        const API_URL = 'https://script.google.com/macros/s/AKfycbxMVxm9StVXrJ2q1eQMNO_pVGud-07clykfCBqvaQwZ0np_NLXKvab0MpOhhDT2P6jDMg/exec';
        const ADMIN_PASSWORD = 'andrii2025';
        
        // --- STATE MANAGEMENT ---
        let isAdminMode = false;
        let portfolioItems = [];
        const ITEMS_PER_PAGE = 12;
        let currentlyShown = 0;
        let filteredItems = [];
        let lightboxItems = [];
        let currentLightboxIndex = 0;

        // --- UTILITY FUNCTIONS ---
        const showNotification = (message, type = 'success') => {
            const el = document.getElementById('notification');
            el.textContent = message;
            el.className = `notification ${type} show`;
            setTimeout(() => el.classList.remove('show'), 3000);
        };

        const updateApiStatus = (status) => {
            const el = document.getElementById('api-status');
            if(!el) return;
            const icons = { online: 'fa-cloud-upload-alt', loading: 'fa-spinner fa-spin', error: 'fa-exclamation-triangle' };
            el.innerHTML = `<i class="fas ${icons[status]}"></i> ${status}`;
            el.className = `api-status ${status}`;
        };
        
        const fileToBase64 = file => new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = () => resolve(reader.result);
            reader.onerror = reject;
        });

        // --- API COMMUNICATION ---
        async function callAPI(action, payload = {}) {
            updateApiStatus('loading');
            const formData = new FormData();
            formData.append('action', action);

            if (action !== 'getAllData') {
                formData.append('password', ADMIN_PASSWORD);
            }
            if (payload.data) {
                formData.append('data', JSON.stringify(payload.data));
            }
            if (payload.file) {
                formData.append('file', (await fileToBase64(payload.file)).split(',')[1]);
                formData.append('filename', payload.file.name);
                formData.append('mimeType', payload.file.type);
            }

            try {
                const response = await fetch(API_URL, { method: 'POST', body: formData });
                if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);
                const result = await response.json();
                if (result.status !== 200) throw new Error(result.data?.error || 'Unknown API Error');
                updateApiStatus('online');
                return result.data;
            } catch (error) {
                console.error('API Call Failed:', error);
                showNotification(error.message, 'error');
                updateApiStatus('error');
                throw error;
            }
        }
        
        async function saveData() {
            if (!isAdminMode) return;
            await callAPI('saveAllData', { data: { portfolioItems } }); // Simplified save
        }
        
        // --- MEDIA RENDERING ---
        function createMediaContent(item, isLightbox = false) {
            let { url, category, mediaType } = item;
            if (!url) return `<div class="p-4 text-red-500">Error: Media URL is missing.</div>`;

            // Auto-detect media type if not specified
            if (!mediaType) {
                if (url.includes('youtube.com') || url.includes('youtu.be') || (url.includes('drive.google.com') && url.includes('/preview'))) {
                    mediaType = 'video';
                } else {
                    mediaType = 'photo';
                }
            }
            
            // Re-format Google Drive image URLs to a reliable format
            if (mediaType === 'photo' && url.includes('drive.google.com')) {
                const match = url.match(/\/d\/([a-zA-Z0-9-_]+)/) || url.match(/id=([a-zA-Z0-9-_]+)/);
                if (match?.[1]) {
                    url = `https://drive.google.com/thumbnail?id=${match[1]}&sz=w1024`;
                }
            }

            const altText = `Portfolio: ${category || 'Item'}`;
            const errorPlaceholder = `this.onerror=null; this.src='https://placehold.co/600x400/1e1b4b/ffffff?text=Image+Error';`;

            if (isLightbox) {
                const lightboxClasses = "max-w-[90vw] max-h-[90vh] w-auto h-auto rounded-lg";
                if (mediaType === 'video') {
                    const videoSrc = url.includes('youtube.com') ? `https://www.youtube.com/embed/${url.match(/v=([^&]+)/)[1]}?autoplay=1` : url;
                    return `<iframe class="w-[80vw] h-[80vh]" src="${videoSrc}" frameborder="0" allow="autoplay; fullscreen" allowfullscreen></iframe>`;
                }
                return `<img class="${lightboxClasses}" src="${url}" alt="${altText}" onerror="${errorPlaceholder}">`;
            }

            // Grid view rendering
            if (mediaType === 'video') {
                const videoSrc = url.includes('youtube.com') ? `https://www.youtube.com/embed/${url.match(/v=([^&]+)/)[1]}` : url;
                return `<iframe class="w-full h-[280px] block" src="${videoSrc}" frameborder="0" allow="fullscreen; picture-in-picture" allowfullscreen></iframe>`;
            }
            return `<img class="w-full h-auto block" src="${url}" alt="${altText}" loading="lazy" onerror="${errorPlaceholder}">`;
        }
        
        function renderPortfolio(reset = false) {
            const grid = document.getElementById('portfolio-grid');
            if (reset) {
                grid.innerHTML = '';
                currentlyShown = 0;
            }
            
            applyCurrentFilters();
            if (filteredItems.length === 0 && reset) {
                grid.innerHTML = `<div class="col-span-3 text-center py-12 text-gray-500">No items match the filter.</div>`;
                updateLoadMoreButton();
                return;
            }

            const itemsToShow = filteredItems.slice(currentlyShown, currentlyShown + ITEMS_PER_PAGE);
            const fragment = document.createDocumentFragment();
            itemsToShow.forEach(item => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'portfolio-item cursor-pointer';
                itemDiv.innerHTML = `
                    ${createMediaContent(item, false)}
                    <button class="delete-btn admin-only absolute top-3 right-3 bg-red-600 text-white rounded-full w-8 h-8 flex items-center justify-center text-lg z-10 hover:bg-red-700 transition-all">√ó</button>
                `;
                itemDiv.addEventListener('click', () => openLightbox(item));
                itemDiv.querySelector('.delete-btn').addEventListener('click', (e) => {
                    e.stopPropagation();
                    if(confirm('Are you sure you want to delete this item?')) {
                        portfolioItems = portfolioItems.filter(p => p.id !== item.id);
                        saveData().then(() => renderPortfolio(true));
                    }
                });
                fragment.appendChild(itemDiv);
            });
            grid.appendChild(fragment);
            currentlyShown += itemsToShow.length;
            updateLoadMoreButton();
        }
        
        // --- FILTERING & PAGINATION ---
        function applyCurrentFilters() {
            const mediaFilter = document.querySelector('.portfolio-filter.active').dataset.filter;
            const categoryFilter = document.getElementById('category-select').value;
            
            filteredItems = portfolioItems.filter(item => {
                let itemMediaType = item.mediaType;
                if (!itemMediaType) { // Auto-detect if not present
                     itemMediaType = (item.url.includes('youtube.com') || (item.url.includes('drive.google.com') && item.url.includes('/preview'))) ? 'video' : 'photo';
                }
                const mediaMatch = mediaFilter === 'all' || (mediaFilter === 'videos' && itemMediaType === 'video') || (mediaFilter === 'photos' && itemMediaType === 'photo');
                const categoryMatch = categoryFilter === 'all' || item.category === categoryFilter;
                return mediaMatch && categoryMatch;
            });
        }
        
        function updateLoadMoreButton() {
            const container = document.getElementById('load-more-container');
            container.style.display = currentlyShown < filteredItems.length ? 'block' : 'none';
        }

        // --- LIGHTBOX ---
        function openLightbox(item) {
            applyCurrentFilters();
            lightboxItems = filteredItems;
            currentLightboxIndex = lightboxItems.findIndex(i => i.id === item.id);

            document.getElementById('lightbox').classList.add('active');
            updateLightboxContent();
            updateLightboxNavigation();
        }

        const closeLightbox = () => {
            document.getElementById('lightbox').classList.remove('active');
            document.getElementById('lightbox-content').innerHTML = ''; // Stop videos
        };

        const updateLightboxContent = () => {
            document.getElementById('lightbox-content').innerHTML = createMediaContent(lightboxItems[currentLightboxIndex], true);
        };
        
        const updateLightboxNavigation = () => {
            const showNav = lightboxItems.length > 1;
            document.getElementById('lightbox-prev').style.display = showNav ? 'flex' : 'none';
            document.getElementById('lightbox-next').style.display = showNav ? 'flex' : 'none';
            document.getElementById('lightbox-counter').style.display = showNav ? 'block' : 'none';
            if(showNav) document.getElementById('lightbox-counter').textContent = `${currentLightboxIndex + 1} / ${lightboxItems.length}`;
        };

        const navigateLightbox = (direction) => {
            currentLightboxIndex = (currentLightboxIndex + direction + lightboxItems.length) % lightboxItems.length;
            updateLightboxContent();
            updateLightboxNavigation();
        };

        // --- MODALS & ADMIN ---
        const setupModal = (id, openFn, closeFn, formId, submitFn) => {
            const modal = document.getElementById(id);
            window[openFn] = () => modal.classList.add('active');
            window[closeFn] = () => modal.classList.remove('active');
            if(formId) document.getElementById(formId).addEventListener('submit', submitFn);
            modal.addEventListener('click', (e) => e.target === modal && window[closeFn]());
        };

        // --- INITIALIZATION ---
        async function initializeApp() {
            // Event Listeners
            document.querySelectorAll('.portfolio-filter').forEach(btn => btn.addEventListener('click', function() {
                document.querySelector('.portfolio-filter.active')?.classList.remove('active', 'bg-gradient-to-r', 'from-purple-500', 'to-pink-500');
                this.classList.add('active', 'bg-gradient-to-r', 'from-purple-500', 'to-pink-500');
                renderPortfolio(true);
            }));
            document.getElementById('category-select').addEventListener('change', () => renderPortfolio(true));
            document.getElementById('load-more-btn').addEventListener('click', () => renderPortfolio(false));
            document.getElementById('lightbox-close').addEventListener('click', closeLightbox);
            document.getElementById('lightbox-prev').addEventListener('click', () => navigateLightbox(-1));
            document.getElementById('lightbox-next').addEventListener('click', () => navigateLightbox(1));
            document.addEventListener('keydown', e => {
                if (document.getElementById('lightbox').classList.contains('active')) {
                    if (e.key === 'Escape') closeLightbox();
                    if (e.key === 'ArrowLeft') navigateLightbox(-1);
                    if (e.key === 'ArrowRight') navigateLightbox(1);
                }
            });

            // Modals
            setupModal('password-modal', 'openPasswordModal', 'closePasswordModal', 'password-form', e => {
                e.preventDefault();
                if (document.getElementById('admin-password').value === ADMIN_PASSWORD) {
                    isAdminMode = true;
                    document.body.classList.add('admin-mode');
                    showNotification('Admin mode ON', 'success');
                    closePasswordModal();
                } else showNotification('Incorrect password', 'error');
            });
            setupModal('portfolio-modal', 'openPortfolioModal', 'closePortfolioModal', 'portfolio-form', async (e) => {
                e.preventDefault();
                const file = document.getElementById('portfolio-file').files[0];
                let url = document.getElementById('portfolio-url').value;
                if (!file && !url) return showNotification('File or URL required', 'error');
                
                showNotification('Uploading...', 'success');
                if (file) {
                    url = (await callAPI('uploadFile', { file })).url;
                }
                
                const newItem = {
                    id: `p_${Date.now()}`,
                    category: document.getElementById('portfolio-category').value,
                    mediaType: document.getElementById('portfolio-media-type').value,
                    url: url,
                    uploadedAt: new Date().toISOString()
                };
                portfolioItems.unshift(newItem);
                await saveData();
                renderPortfolio(true);
                closePortfolioModal();
            });
            // Simplified admin toggle
            document.getElementById('admin-toggle').addEventListener('click', () => isAdminMode ? (isAdminMode=false, document.body.classList.remove('admin-mode'), showNotification('Admin mode OFF')) : openPasswordModal());

            // Load Data & Render
            try {
                const data = await callAPI('getAllData');
                portfolioItems = data.portfolioItems || [];
                // Load other data like technologies, contacts if needed
            } catch (e) {
                showNotification("Could not load portfolio from server.", "error");
            }
            renderPortfolio(true);
        }

        initializeApp();
    </script>
</body>
</html>
