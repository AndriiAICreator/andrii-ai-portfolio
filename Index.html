<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Andrii - AI Creator | Professional AI Services</title>
    <meta name="description" content="Professional AI services: avatars, voiceover, image and video generation, e-commerce creatives, virtual photoshoots">
    
    <!-- Favicon - Robot Icon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><path d='M50,10 C70,10 85,25 85,45 C85,65 70,80 50,80 S15,65 15,45 C15,25 30,10 50,10 M50,80 C50,85 45,90 50,90 M50,80 C40,80 35,75 35,70 M50,80 C60,80 65,75 65,70 M50,10 C50,25 40,30 40,45 M50,10 C50,25 60,30 60,45 M35,70 C25,65 20,55 20,45 M65,70 C75,65 80,55 80,45' stroke='%23f093fb' stroke-width='6' fill='none' stroke-linecap='round' stroke-linejoin='round' filter='url(%23glow)'/><defs><filter id='glow'><feDropShadow dx='0' dy='0' stdDeviation='2' flood-color='%23f093fb'/></filter></defs></svg>">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><path d='M50,10 C70,10 85,25 85,45 C85,65 70,80 50,80 S15,65 15,45 C15,25 30,10 50,10 M50,80 C50,85 45,90 50,90 M50,80 C40,80 35,75 35,70 M50,80 C60,80 65,75 65,70 M50,10 C50,25 40,30 40,45 M50,10 C50,25 60,30 60,45 M35,70 C25,65 20,55 20,45 M65,70 C75,65 80,55 80,45' stroke='%23f093fb' stroke-width='6' fill='none' stroke-linecap='round' stroke-linejoin='round' filter='url(%23glow)'/><defs><filter id='glow'><feDropShadow dx='0' dy='0' stdDeviation='2' flood-color='%23f093fb'/></filter></defs></svg>">
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer">
    <!-- Backup Font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.5.1/css/all.css">
    
    <style>
        body { 
            font-family: 'Inter', sans-serif; 
            background: radial-gradient(ellipse at top, #1e1b4b 0%, #0f0f23 50%, #000000 100%);
            color: #ffffff;
            overflow-x: hidden;
        }
        
        /* Epic Gradient Backgrounds */
        .gradient-bg { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            position: relative;
            overflow: hidden;
            width: 100%;
            max-width: 100vw;
        }

        .tech-card h4 {
    overflow-wrap: break-word;
        }
        
        .gradient-bg::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><radialGradient id="g" cx="50%" cy="50%" r="50%"><stop offset="0%" style="stop-color:rgba(255,255,255,0.1);stop-opacity:1" /><stop offset="100%" style="stop-color:rgba(255,255,255,0);stop-opacity:0" /></radialGradient></defs><circle cx="20" cy="20" r="3" fill="url(%23g)" /><circle cx="80" cy="40" r="2" fill="url(%23g)" /><circle cx="40" cy="80" r="4" fill="url(%23g)" /><circle cx="90" cy="90" r="2" fill="url(%23g)" /><circle cx="10" cy="60" r="3" fill="url(%23g)" /></svg>') repeat;
            animation: sparkle 20s linear infinite;
        }
        
        .epic-card {
            background: linear-gradient(145deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
            backdrop-filter: blur(10px); /* Зменшено з 20px до 10px */
            border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 0 15px 30px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.3); /* Зменшено тінь */
            contain: layout style paint; /* Додано paint для кращої оптимізації */
            will-change: transform; /* Оптимізація для анімацій */
        }
        
        .service-card {
            background: linear-gradient(145deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
            backdrop-filter: blur(12px); /* Зменшено з 20px до 12px */
            border: 1px solid rgba(255,255,255,0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease; /* Оптимізовано */
            will-change: transform; /* Оптимізація для анімацій */
        }
        .service-card:hover { 
            transform: translateY(-20px) scale(1.05);
            box-shadow: 0 50px 100px rgba(139, 92, 246, 0.3), 0 0 50px rgba(139, 92, 246, 0.2);
            border-color: rgba(139, 92, 246, 0.5);
        }
        
        .floating { animation: floating 6s ease-in-out infinite; }
        @keyframes floating {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            25% { transform: translateY(-15px) rotate(2deg); }
            50% { transform: translateY(-30px) rotate(0deg); }
            75% { transform: translateY(-15px) rotate(-2deg); }
        }
        
        @keyframes sparkle {
            0% { transform: translateX(0) translateY(0); }
            100% { transform: translateX(-100px) translateY(-100px); }
        }
        
        .sparkle {
    position: fixed;
    top: 0;
    left: 0;
    pointer-events: none; /* Ігнорування кліків */
    border-radius: 50%;
    z-index: 9999;

    /* Анімація зникнення */
    animation: sparkle-fade-out 1s forwards;
}

@keyframes sparkle-fade-out {
    0% {
        transform: scale(1);
        opacity: 1;
    }
    100% {
        transform: scale(0);
        opacity: 0;
    }
}

/* Збільшуємо розмір світла при наведенні на посилання/кнопки */
body:has(a:hover, button:hover, .portfolio-item:hover) #spotlight-overlay {
    mask-size: 250px;
}
        
        .simple-glow:hover {
            box-shadow: 
                0 0 20px rgba(139, 92, 246, 0.3),
                0 0 40px rgba(139, 92, 246, 0.2);
        }
        
        .neon-text {
            color: #ffffff;
            text-shadow: 
                0 0 5px #fff,
                0 0 10px #fff,
                0 0 15px #8b5cf6,
                0 0 20px #8b5cf6,
                0 0 35px #8b5cf6,
                0 0 40px #8b5cf6;
        }
        
        .glow-box {
            box-shadow: 
                0 0 20px rgba(139, 92, 246, 0.3),
                0 0 40px rgba(139, 92, 246, 0.2),
                0 0 60px rgba(139, 92, 246, 0.1),
                inset 0 0 20px rgba(255, 255, 255, 0.1);
        }
        .tech-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 2rem; }
        .tech-card {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.4s ease, transform 0.4s ease; /* Оптимізовано */
            will-change: transform, opacity; /* Оптимізація для анімацій */
            contain: layout style; /* Додано для кращої продуктивності */
        }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .admin-panel { display: none; }
        .admin-mode .admin-panel { display: block; }
        .admin-mode .admin-only { display: block !important; }
        .admin-only { display: none; }
        .portfolio-item { position: relative; }
        .admin-mode .portfolio-item:hover .delete-btn { 
            display: flex !important; 
            align-items: center; 
            justify-content: center;
            z-index: 20;
        }
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 100; }
        .modal.active { display: flex; align-items: center; justify-content: center; }
        .notification { position: fixed; top: 20px; right: 20px; z-index: 200; padding: 12px 24px; border-radius: 8px; color: white; font-weight: 500; transform: translateX(400px); transition: transform 0.3s ease; }
        .notification.show { transform: translateX(0); }
        .notification.success { background: #10b981; }
        .notification.error { background: #ef4444; }
        
        /* Portfolio Grid - Stable Masonry Layout */
        .portfolio-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 2rem;
            align-items: start;
        }
        
        .portfolio-item {
            width: 100%;
            background: linear-gradient(145deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
            backdrop-filter: blur(8px); /* Значно зменшено з 20px до 8px */
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 24px;
            overflow: hidden;
            transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease; /* Оптимізовано */
            position: relative;
            will-change: transform; /* Оптимізація для анімацій */
            contain: layout style paint; /* Додано для кращої продуктивності */
        }
        
        .portfolio-item:hover {
            transform: translateY(-15px) scale(1.03);
            box-shadow: 
                0 40px 80px rgba(139, 92, 246, 0.4), 
                0 0 40px rgba(139, 92, 246, 0.3),
                0 0 0 1px rgba(139, 92, 246, 0.2);
            border-color: rgba(139, 92, 246, 0.6);
            z-index: 10;
        }
        
        .portfolio-item img {
            width: 100%;
            height: auto;
            display: block;
            object-fit: cover;
            transition: transform 0.4s ease, filter 0.4s ease;
            border-radius: 20px 20px 0 0;
        }
        
        .portfolio-item:hover img {
            transform: scale(1.08);
            filter: brightness(1.1) contrast(1.1);
        }
        
        .portfolio-item video, .portfolio-item iframe {
            width: 100%;
            height: 280px;
            border-radius: 20px 20px 0 0;
            display: block;
            border: none;
        }
        
        .portfolio-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, 
                rgba(139, 92, 246, 0.1) 0%,
                rgba(59, 130, 246, 0.1) 50%,
                rgba(236, 72, 153, 0.1) 100%
            );
            opacity: 0;
            transition: opacity 0.4s ease;
            border-radius: 24px;
            pointer-events: none;
        }
        
        .portfolio-item:hover::before {
            opacity: 1;
        }
        
        /* Responsive Grid */
        @media (max-width: 1200px) {
            .portfolio-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 1.5rem;
            }
        }
        
        @media (max-width: 768px) {
            .portfolio-grid {
                grid-template-columns: 1fr;
                gap: 2rem;
            }
           .tech-card h4 {
        font-size: 0.875rem; /* Зменшуємо шрифт (відповідає text-sm в Tailwind) */
        text-align: center;  /* Залишаємо вирівнювання по центру, але... */
        line-height: 1.4;    /* Трохи збільшуємо інтервал між рядками для читабельності */
        min-height: 2.5rem;  /* Задаємо мінімальну висоту, щоб картки не "стрибали" по висоті */
        display: flex;       /* Включаємо Flexbox */
        align-items: center; /* Центруємо текст вертикально */
        justify-content: center; /* Центруємо текст горизонтально */
    }
            .portfolio-item {
                max-width: 100%;
            }
            
            .portfolio-item video, .portfolio-item iframe {
                min-height: 250px;
            }
        }
        
        .portfolio-item {
            opacity: 0;
            transform: translateY(20px) scale(0.98); /* Зменшено з 30px до 20px та scale з 0.95 до 0.98 */
            transition: opacity 0.4s ease, transform 0.4s ease; /* Замінено animation на transition для кращої продуктивності */
        }
        
        .portfolio-item.visible {
            opacity: 1;
            transform: translateY(0) scale(1);
        }

        /* Lightbox Styles */
        .lightbox { 
            display: none; 
            position: fixed; 
            inset: 0; 
            background: rgba(0,0,0,0.95); 
            z-index: 300;
            padding: 20px;
        }
        .lightbox.active { 
            display: flex; 
            align-items: center; 
            justify-content: center; 
        }
        .lightbox-content { 
            max-width: 90vw; 
            max-height: 90vh; 
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .lightbox img { 
            max-width: 90vw; 
            max-height: 90vh; 
            width: auto; 
            height: auto; 
            object-fit: contain; 
            border-radius: 8px; 
        }
        .lightbox video, .lightbox iframe { 
            max-width: 90vw; 
            max-height: 90vh; 
            width: auto;
            height: auto;
            border-radius: 8px;
            display: block;
        }
        .lightbox-nav { 
            position: fixed; 
            top: 50%; 
            transform: translateY(-50%); 
            background: rgba(0,0,0,0.7); 
            color: white; 
            border: 2px solid rgba(255,255,255,0.3);
            width: 60px; 
            height: 60px; 
            border-radius: 50%; 
            cursor: pointer; 
            font-size: 24px; 
            z-index: 310;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        .lightbox-nav:hover { 
            background: rgba(255,255,255,0.2); 
            border-color: rgba(255,255,255,0.6);
            transform: translateY(-50%) scale(1.1);
        }
        .lightbox-prev { 
            left: 30px; 
        }
        .lightbox-next { 
            right: 30px; 
        }
        .lightbox-close { 
            position: fixed; 
            top: 30px; 
            right: 30px; 
            background: rgba(0,0,0,0.7); 
            color: white; 
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 24px; 
            cursor: pointer; 
            z-index: 310;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        .lightbox-close:hover { 
            color: #ff4444; 
            background: rgba(255,68,68,0.2);
            border-color: #ff4444;
            transform: scale(1.1);
        }
        
        .lightbox-counter {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            z-index: 310;
        }
        
        @media (max-width: 768px) {
            .lightbox { padding: 10px; }
            .lightbox-nav { 
                width: 50px; 
                height: 50px; 
                font-size: 20px; 
            }
            .lightbox-prev { left: 15px; }
            .lightbox-next { right: 15px; }
            .lightbox-close { 
                top: 15px; 
                right: 15px; 
                width: 45px;
                height: 45px;
                font-size: 20px;
            }
            .lightbox-counter {
                bottom: 15px;
                font-size: 12px;
                padding: 6px 12px;
            }
        }
        
        .lightbox-content {
            touch-action: pan-x;
        }
        
        html {
            overflow-x: hidden;
            scroll-behavior: smooth;
        }
        
        * {
            box-sizing: border-box;
        }
        
        .container {
            max-width: 100%;
            overflow-x: hidden;
        }
        
        .api-status {
            position: fixed;
            top: 80px;
            left: 20px;
            z-index: 50;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
            transition: all 0.3s ease;
            display: none;
        }
        
        .admin-mode .api-status {
            display: block;
        }
        .api-status.online {
            background: #10b981;
            color: white;
        }
        .api-status.offline {
            background: #ef4444;
            color: white;
        }
        .api-status.loading {
            background: #f59e0b;
            color: white;
        }
        
        @media (max-width: 768px) {
            #admin-login {
                bottom: 8px !important;
                right: 8px !important;
                z-index: 30 !important;
            }
            
            .admin-panel {
                bottom: 40px !important;
                left: 8px !important;
                right: 8px !important;
                max-width: none !important;
            }
            
            .hero-section {
                padding-top: 80px !important;
            }
            
            .gradient-bg {
                margin-top: 0 !important;
                padding-top: 100px !important;
            }
            
            .service-card {
                margin-bottom: 1rem;
            }
            
            .tech-grid {
                grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
                gap: 0.75rem;
            }
            
            .portfolio-filter {
                font-size: 0.875rem !important;
                padding: 0.5rem 1rem !important;
                margin-bottom: 0.5rem !important;
            }
            
            #category-filter {
                flex-direction: column !important;
                align-items: flex-start !important;
                gap: 0.5rem !important;
                margin-bottom: 2rem !important;
            }
            
            #category-select {
                width: 100% !important;
                font-size: 0.875rem !important;
            }
        }
    </style>
</head>

<body class="bg-gray-50">
<div id="spotlight-overlay"></div>
    <!-- API Status Indicator -->
    <div id="api-status" class="api-status loading">
        <i class="fas fa-cloud"></i> Connecting...
    </div>

    <!-- Admin Login - Hidden -->
    <div id="admin-login" class="fixed bottom-2 right-2 z-50">
        <button id="admin-toggle" class="bg-gray-900/50 text-gray-500 p-1 rounded text-xs hover:bg-gray-700 hover:text-white transition-all duration-300 opacity-30 hover:opacity-100">
            ⚙
        </button>
    </div>

    <!-- Language Switcher -->
    <div class="fixed top-20 right-4 z-50">
        <div class="bg-white rounded-full shadow-lg p-2 flex items-center space-x-1">
            <button id="lang-en" class="px-2 py-1 rounded-full text-xs font-medium transition-all duration-300 bg-blue-500 text-white">EN</button>
            <button id="lang-ua" class="px-2 py-1 rounded-full text-xs font-medium transition-all duration-300 text-gray-600 hover:bg-gray-100">UA</button>
        </div>
    </div>

    <!-- Admin Panel -->
    <div id="admin-panel" class="admin-panel fixed bottom-12 right-2 bg-gray-800 text-white rounded-lg shadow-lg p-4 z-40 max-w-sm border border-gray-600">
        <h3 class="font-bold mb-4 text-white">🛠️ Admin Panel</h3>
        <div class="space-y-2">
            <button id="add-technology-btn" class="w-full bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-all duration-300 hover:scale-105">
                <i class="fas fa-plus mr-2"></i>Add Technology
            </button>
            <button onclick="openContactModal()" class="w-full bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition-all duration-300 hover:scale-105">
                <i class="fas fa-address-book mr-2"></i>Manage Contacts
            </button>
            <button onclick="testDataLoad()" class="w-full bg-yellow-500 text-white px-4 py-2 rounded-lg hover:bg-yellow-600 transition-all duration-300 hover:scale-105">
                <i class="fas fa-sync mr-2"></i>Test Data Load
            </button>
            <button onclick="removeDuplicatesFromPortfolio()" class="w-full bg-orange-500 text-white px-4 py-2 rounded-lg hover:bg-orange-600 transition-all duration-300 hover:scale-105">
                <i class="fas fa-copy mr-2"></i>Remove Duplicates
            </button>
            <button onclick="fixDateDuplicates()" class="w-full bg-purple-500 text-white px-4 py-2 rounded-lg hover:bg-purple-600 transition-all duration-300 hover:scale-105">
                <i class="fas fa-clock mr-2"></i>Fix Date Duplicates
            </button>
            <button id="clear-portfolio-btn" class="w-full bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition-all duration-300 hover:scale-105">
                <i class="fas fa-trash mr-2"></i>Clear All Portfolio
            </button>
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 text-sm text-blue-800">
                <i class="fas fa-server mr-2"></i>
                <strong>Google Apps Script:</strong> All data synced via Google Sheets & Drive in real-time!
            </div>
        </div>
    </div>

    <!-- Technology Modal -->
    <div id="tech-modal" class="modal">
        <div class="bg-gray-800 text-white rounded-lg p-6 max-w-md w-full mx-4 border border-gray-600">
            <h3 class="text-xl font-bold mb-4 text-white" data-translate="add-tech-title">🛠️ Add Technology</h3>
            <form id="tech-form" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium mb-2 text-gray-300">Technology Name</label>
                    <input type="text" id="tech-name" class="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-purple-400 focus:outline-none" required>
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2 text-gray-300">Emoji/Icon</label>
                    <input type="text" id="tech-emoji" class="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-purple-400 focus:outline-none" placeholder="🎨" required>
                </div>
                <div class="flex gap-2">
                    <button type="submit" class="flex-1 bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600 transition-all duration-300 hover:scale-105">Add</button>
                    <button type="button" onclick="closeTechModal()" class="flex-1 bg-gray-600 text-white py-2 rounded-lg hover:bg-gray-700 transition-all duration-300 hover:scale-105">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Portfolio Upload Modal -->
    <div id="portfolio-modal" class="modal">
        <div class="bg-gray-800 text-white rounded-lg p-6 max-w-md w-full mx-4 border border-gray-600">
            <h3 class="text-xl font-bold mb-4 text-white" data-translate="add-portfolio-title">📁 Add Portfolio Item</h3>
            <form id="portfolio-form" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium mb-2 text-gray-300">Category</label>
                    <select id="portfolio-category" class="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-purple-400 focus:outline-none" required>
                        <option value="avatars">AI Avatars</option>
                        <option value="image-generation">Image Generation</option>
                        <option value="video-creation">Video Creation</option>
                        <option value="ecommerce">E-commerce</option>
                        <option value="virtual-shoots">Virtual Shoots</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2 text-gray-300">Media Type</label>
                    <select id="portfolio-media-type" class="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-purple-400 focus:outline-none" required>
                        <option value="photo">📸 Photo</option>
                        <option value="video">🎬 Video</option>
                    </select>
                </div>

                <div>
                    <label class="block text-sm font-medium mb-2 text-gray-300">File/URL</label>
                    <input type="text" id="portfolio-url" class="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-purple-400 focus:outline-none" placeholder="Image URL, YouTube, Google Drive, Dropbox, etc.">
                    <div class="mt-2">
                        <label class="block text-sm font-medium text-gray-300 mb-1">Or upload file directly:</label>
                        <input type="file" id="portfolio-file" class="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-purple-400 focus:outline-none" accept="image/*,video/*">
                    </div>
                    <div class="mt-2 text-xs text-gray-400">
                        <strong class="text-gray-300">🔥 Google Drive Upload (Recommended):</strong><br>
                        • Select file directly - uploaded to Google Drive<br>
                        • Images: JPG, PNG, GIF, WebP (max 50MB)<br>
                        • Videos: MP4, MOV, WebM (max 50MB)<br><br>
                        <strong class="text-gray-300">🌐 External URLs (Also supported):</strong><br>
                        • YouTube: youtube.com/watch?v=...<br>
                        • Google Drive: drive.google.com/file/d/.../view<br>
                        • Dropbox: dropbox.com/s/.../video.mp4<br>
                        • Direct image/video URLs
                    </div>
                </div>
                <div class="flex gap-2">
                    <button type="submit" class="flex-1 bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600 transition-all duration-300 hover:scale-105">Add</button>
                    <button type="button" onclick="closePortfolioModal()" class="flex-1 bg-gray-600 text-white py-2 rounded-lg hover:bg-gray-700 transition-all duration-300 hover:scale-105">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Contact Modal -->
    <div id="contact-modal" class="modal">
        <div class="bg-gray-800 text-white rounded-lg p-6 max-w-md w-full mx-4 border border-gray-600">
            <h3 class="text-xl font-bold mb-4 text-white">📞 Add/Edit Contact</h3>
            <form id="contact-form-modal" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium mb-2 text-gray-300">Platform</label>
                    <select id="contact-platform" class="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-purple-400 focus:outline-none" required>
                        <option value="email">Email</option>
                        <option value="telegram">Telegram</option>
                        <option value="instagram">Instagram</option>
                        <option value="tiktok">TikTok</option>
                        <option value="linkedin">LinkedIn</option>
                        <option value="youtube">YouTube</option>
                        <option value="twitter">Twitter</option>
                        <option value="whatsapp">WhatsApp</option>
                        <option value="facebook">Facebook</option>
                        <option value="discord">Discord</option>
                        <option value="phone">Phone</option>
                        <option value="website">Website</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2 text-gray-300">Label</label>
                    <input type="text" id="contact-label" class="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-purple-400 focus:outline-none" placeholder="e.g., @dream_ailab" required>
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2 text-gray-300">URL/Link</label>
                    <input type="text" id="contact-url" class="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-purple-400 focus:outline-none" placeholder="Full URL or email/phone" required>
                </div>
                <div class="flex gap-2">
                    <button type="submit" class="flex-1 bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600 transition-all duration-300 hover:scale-105">Save</button>
                    <button type="button" onclick="closeContactModal()" class="flex-1 bg-gray-600 text-white py-2 rounded-lg hover:bg-gray-700 transition-all duration-300 hover:scale-105">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Admin Password Modal -->
    <div id="password-modal" class="modal">
        <div class="bg-gray-800 text-white rounded-lg p-6 max-w-md w-full mx-4 border border-gray-600">
            <h3 class="text-xl font-bold mb-4 text-white">🔐 Admin Access</h3>
            <form id="password-form" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium mb-2 text-gray-300">Password</label>
                    <input type="password" id="admin-password" class="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:border-purple-400 focus:outline-none" required>
                </div>
                <div class="flex gap-2">
                    <button type="submit" class="flex-1 bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600 transition-all duration-300 hover:scale-105">Login</button>
                    <button type="button" onclick="closePasswordModal()" class="flex-1 bg-gray-600 text-white py-2 rounded-lg hover:bg-gray-700 transition-all duration-300 hover:scale-105">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="bg-black/80 backdrop-filter backdrop-blur-lg border-b border-purple-500/30 shadow-2xl fixed w-full top-0 z-40">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="font-bold text-2xl bg-gradient-to-r from-purple-400 to-pink-500 bg-clip-text text-transparent">✨ Andrii AI</div>
                
                <!-- Desktop Navigation -->
                <div class="hidden md:flex space-x-8">
                    <a href="#about" data-translate="nav-about" class="text-gray-300 hover:text-cyan-400 transition-all duration-300 hover:scale-110 font-semibold">About</a>
                    <a href="#services" data-translate="nav-services" class="text-gray-300 hover:text-purple-400 transition-all duration-300 hover:scale-110 font-semibold">Services</a>
                    <a href="#portfolio" data-translate="nav-portfolio" class="text-gray-300 hover:text-pink-400 transition-all duration-300 hover:scale-110 font-semibold">Portfolio</a>
                    <a href="#contact" data-translate="nav-contact" class="text-gray-300 hover:text-green-400 transition-all duration-300 hover:scale-110 font-semibold">Contact</a>
                </div>
                
                <!-- Mobile Menu Button -->
                <button id="mobile-menu-button" class="md:hidden p-2 rounded-md text-gray-700 hover:text-blue-600 hover:bg-gray-100 transition-colors">
                    <i class="fas fa-bars text-xl"></i>
                </button>
            </div>
            
            <!-- Mobile Navigation Menu -->
            <div id="mobile-menu" class="md:hidden hidden bg-white border-t border-gray-200">
                <div class="px-2 pt-2 pb-3 space-y-1">
                    <a href="#about" data-translate="nav-about" class="mobile-nav-link block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-blue-600 hover:bg-gray-50 transition-colors">About</a>
                    <a href="#services" data-translate="nav-services" class="mobile-nav-link block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-blue-600 hover:bg-gray-50 transition-colors">Services</a>
                    <a href="#portfolio" data-translate="nav-portfolio" class="mobile-nav-link block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-blue-600 hover:bg-gray-50 transition-colors">Portfolio</a>
                    <a href="#contact" data-translate="nav-contact" class="mobile-nav-link block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-blue-600 hover:bg-gray-50 transition-colors">Contact</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="gradient-bg text-white py-20 mt-16 relative min-h-screen flex items-center">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
            <div class="text-center">
                <div class="floating mb-8">
                    <div class="w-40 h-40 mx-auto bg-gradient-to-br from-purple-400 via-pink-500 to-red-500 rounded-full flex items-center justify-center shadow-2xl glow-box relative">
                        <div class="absolute inset-2 bg-gradient-to-br from-blue-600 via-purple-600 to-pink-600 rounded-full flex items-center justify-center">
                            <i class="fas fa-robot text-6xl text-white neon-text"></i>
                        </div>
                        <div class="absolute -inset-4 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full opacity-30 blur-lg animate-pulse"></div>
                    </div>
                </div>
                <div class="bg-black/30 backdrop-blur-md rounded-3xl p-8 mx-auto max-w-5xl border border-white/20">
                    <h1 class="text-5xl md:text-8xl font-bold mb-6">
                        <span data-translate="hero-greeting" class="text-white drop-shadow-lg">Hi, I'm</span> <br>
                        <span class="bg-gradient-to-r from-yellow-400 via-orange-500 to-red-500 bg-clip-text text-transparent animate-pulse">Andrii</span>
                    </h1>
                    <p class="text-2xl md:text-4xl mb-8 text-cyan-300 font-semibold drop-shadow-lg" data-translate="hero-subtitle">
                        AI Creator | Artificial Intelligence Creator
                    </p>
                    <p class="text-lg md:text-xl mb-10 text-white leading-relaxed drop-shadow-md" data-translate="hero-description">
                        I create incredible AI avatars, generate unique images and videos, voice content in 70+ languages. I bring your ideas to life using cutting-edge AI technologies.
                    </p>
                </div>
                <div class="flex flex-col sm:flex-row gap-6 justify-center">
                    <a href="#services" class="epic-card px-10 py-4 rounded-full font-bold text-lg text-white hover:scale-110 transform transition-all duration-300 relative overflow-hidden group shadow-lg hover:shadow-cyan-500/50 hover:bg-gradient-to-r hover:from-cyan-500 hover:to-purple-500" data-translate="hero-services-btn">
                        <span class="relative z-10">🚀 My Services</span>
                    </a>
                    <a href="#contact" class="epic-card border-2 border-purple-400 px-10 py-4 rounded-full font-bold text-lg text-white hover:scale-110 hover:bg-gradient-to-r hover:from-purple-500 hover:to-pink-500 hover:border-transparent transform transition-all duration-300 shadow-lg hover:shadow-pink-500/50" data-translate="hero-contact-btn">
                        💬 Get in Touch
                    </a>
                </div>
            </div>
        </div>
        
        <!-- Floating Particles -->
        <div class="absolute inset-0 overflow-hidden">
            <div class="absolute top-1/4 left-1/4 w-4 h-4 bg-purple-500 rounded-full opacity-60 animate-ping"></div>
            <div class="absolute top-1/3 right-1/4 w-2 h-2 bg-pink-500 rounded-full opacity-40 animate-pulse"></div>
            <div class="absolute bottom-1/4 left-1/3 w-3 h-3 bg-blue-500 rounded-full opacity-50 animate-bounce"></div>
            <div class="absolute top-1/2 right-1/3 w-2 h-2 bg-yellow-500 rounded-full opacity-60 animate-ping"></div>
            <div class="absolute bottom-1/3 right-1/4 w-4 h-4 bg-cyan-500 rounded-full opacity-30 animate-pulse"></div>
        </div>
    </section>

    <!-- About Section -->
    <section id="about" class="py-20 bg-gradient-to-b from-gray-900 to-black relative">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
            <div class="text-center mb-16">
                <h2 class="text-4xl md:text-6xl font-bold mb-6 bg-gradient-to-r from-purple-400 to-pink-500 bg-clip-text text-transparent" data-translate="about-title">About Me</h2>
                <p class="text-xl md:text-2xl text-gray-300 max-w-4xl mx-auto leading-relaxed" data-translate="about-description">
                    I specialize in creating high-quality AI content for business and creative projects. I use the best AI tools to achieve your goals. I also do professional video editing and post-production to bring your content to the next level.
                </p>
            </div>
            
            <div class="grid md:grid-cols-3 gap-8">
                <div class="epic-card text-center p-8 rounded-3xl hover:scale-105 transform transition-all duration-500 group relative overflow-hidden">
                    <div class="absolute inset-0 bg-gradient-to-br from-blue-500/20 to-purple-600/20 opacity-0 group-hover:opacity-100 transition-all duration-500"></div>
                    <div class="relative z-10">
                        <div class="w-20 h-20 bg-gradient-to-br from-blue-400 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-6 glow-box group-hover:scale-110 transition-transform duration-500">
                            <i class="fas fa-brain text-3xl text-white"></i>
                        </div>
                        <h3 class="text-2xl font-bold mb-4 text-white" data-translate="about-innovation">🧠 Innovation</h3>
                        <p class="text-gray-300 text-lg" data-translate="about-innovation-desc">Using the latest AI technologies</p>
                    </div>
                </div>
                <div class="epic-card text-center p-8 rounded-3xl hover:scale-105 transform transition-all duration-500 group relative overflow-hidden">
                    <div class="absolute inset-0 bg-gradient-to-br from-green-500/20 to-cyan-600/20 opacity-0 group-hover:opacity-100 transition-all duration-500"></div>
                    <div class="relative z-10">
                        <div class="w-20 h-20 bg-gradient-to-br from-green-400 to-cyan-600 rounded-full flex items-center justify-center mx-auto mb-6 glow-box group-hover:scale-110 transition-transform duration-500">
                            <i class="fas fa-palette text-3xl text-white"></i>
                        </div>
                        <h3 class="text-2xl font-bold mb-4 text-white" data-translate="about-creativity">🎨 Creativity</h3>
                        <p class="text-gray-300 text-lg" data-translate="about-creativity-desc">Bringing any creative ideas to life</p>
                    </div>
                </div>
                <div class="epic-card text-center p-8 rounded-3xl hover:scale-105 transform transition-all duration-500 group relative overflow-hidden">
                    <div class="absolute inset-0 bg-gradient-to-br from-purple-500/20 to-pink-600/20 opacity-0 group-hover:opacity-100 transition-all duration-500"></div>
                    <div class="relative z-10">
                        <div class="w-20 h-20 bg-gradient-to-br from-purple-400 to-pink-600 rounded-full flex items-center justify-center mx-auto mb-6 glow-box group-hover:scale-110 transition-transform duration-500">
                            <i class="fas fa-rocket text-3xl text-white"></i>
                        </div>
                        <h3 class="text-2xl font-bold mb-4 text-white" data-translate="about-speed">⚡ Speed</h3>
                        <p class="text-gray-300 text-lg" data-translate="about-speed-desc">Fast project delivery</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Services Section -->
    <section id="services" class="py-20 bg-gradient-to-b from-black to-gray-900 relative">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
            <div class="text-center mb-16">
                <h2 class="text-4xl md:text-6xl font-bold mb-6 bg-gradient-to-r from-cyan-400 to-purple-500 bg-clip-text text-transparent" data-translate="services-title">My Services</h2>
                <p class="text-xl md:text-2xl text-gray-300" data-translate="services-subtitle">Professional AI solutions for your business</p>
            </div>

            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- AI Avatars -->
                <div class="service-card p-8 rounded-3xl relative group overflow-hidden">
                    <div class="absolute inset-0 bg-gradient-to-br from-blue-500/20 to-purple-600/20 opacity-0 group-hover:opacity-100 transition-all duration-500"></div>
                    <div class="relative z-10">
                        <div class="w-20 h-20 bg-gradient-to-br from-blue-500 to-purple-600 rounded-2xl flex items-center justify-center mb-6 glow-box group-hover:scale-110 transition-all duration-500">
                            <i class="fas fa-user-circle text-3xl text-white"></i>
                        </div>
                        <h3 class="text-2xl font-bold mb-4 text-white" data-translate="service-avatars-title">👤 AI Avatars</h3>
                        <p class="text-gray-300 mb-6 text-lg leading-relaxed" data-translate="service-avatars-desc">
                            I create realistic AI avatars for business, advertising, presentations, social media, games, apps and any other needs.
                        </p>
                        <ul class="text-gray-400 space-y-3">
                            <li data-translate="service-avatars-1" class="flex items-center"><span class="w-2 h-2 bg-blue-400 rounded-full mr-3"></span>Corporate representatives</li>
                            <li data-translate="service-avatars-2" class="flex items-center"><span class="w-2 h-2 bg-purple-400 rounded-full mr-3"></span>Social media characters</li>
                            <li data-translate="service-avatars-3" class="flex items-center"><span class="w-2 h-2 bg-pink-400 rounded-full mr-3"></span>Gaming and app avatars</li>
                            <li data-translate="service-avatars-4" class="flex items-center"><span class="w-2 h-2 bg-cyan-400 rounded-full mr-3"></span>Virtual hosts</li>
                        </ul>
                    </div>
                </div>

                <!-- Voice Services -->
                <div class="service-card p-8 rounded-3xl relative group overflow-hidden">
                    <div class="absolute inset-0 bg-gradient-to-br from-green-500/20 to-teal-600/20 opacity-0 group-hover:opacity-100 transition-all duration-500"></div>
                    <div class="relative z-10">
                        <div class="w-20 h-20 bg-gradient-to-br from-green-500 to-teal-600 rounded-2xl flex items-center justify-center mb-6 glow-box group-hover:scale-110 transition-transform duration-500">
                            <i class="fas fa-microphone text-3xl text-white"></i>
                        </div>
                        <h3 class="text-2xl font-bold mb-4 text-white" data-translate="service-voice-title">🎙️ AI Voice</h3>
                        <p class="text-gray-300 mb-6 text-lg leading-relaxed" data-translate="service-voice-desc">
                            Professional voiceover for texts, avatars and audiobooks in 70+ languages. Video translation and voiceover.
                        </p>
                        <ul class="text-gray-400 space-y-3">
                            <li data-translate="service-voice-1" class="flex items-center"><span class="w-2 h-2 bg-green-400 rounded-full mr-3"></span>70+ world languages</li>
                            <li data-translate="service-voice-2" class="flex items-center"><span class="w-2 h-2 bg-teal-400 rounded-full mr-3"></span>Audiobook narration</li>
                            <li data-translate="service-voice-3" class="flex items-center"><span class="w-2 h-2 bg-cyan-400 rounded-full mr-3"></span>Video translation</li>
                            <li data-translate="service-voice-4" class="flex items-center"><span class="w-2 h-2 bg-blue-400 rounded-full mr-3"></span>Avatar voices</li>
                        </ul>
                    </div>
                </div>

                <!-- Image Generation -->
                <div class="service-card p-8 rounded-3xl relative group overflow-hidden">
                    <div class="absolute inset-0 bg-gradient-to-br from-pink-500/20 to-rose-600/20 opacity-0 group-hover:opacity-100 transition-all duration-500"></div>
                    <div class="relative z-10">
                        <div class="w-20 h-20 bg-gradient-to-br from-pink-500 to-rose-600 rounded-2xl flex items-center justify-center mb-6 glow-box group-hover:scale-110 transition-transform duration-500">
                            <i class="fas fa-image text-3xl text-white"></i>
                        </div>
                        <h3 class="text-2xl font-bold mb-4 text-white" data-translate="service-images-title">🎨 Image Generation</h3>
                        <p class="text-gray-300 mb-6 text-lg leading-relaxed" data-translate="service-images-desc">
                            I create unique images using Midjourney, FLUX, Stable Diffusion, Krea and other AI services.
                        </p>
                        <ul class="text-gray-400 space-y-3">
                            <li data-translate="service-images-1" class="flex items-center"><span class="w-2 h-2 bg-pink-400 rounded-full mr-3"></span>Realistic photographs</li>
                            <li data-translate="service-images-2" class="flex items-center"><span class="w-2 h-2 bg-rose-400 rounded-full mr-3"></span>Creative illustrations</li>
                            <li data-translate="service-images-3" class="flex items-center"><span class="w-2 h-2 bg-red-400 rounded-full mr-3"></span>Cartoon characters</li>
                            <li data-translate="service-images-4" class="flex items-center"><span class="w-2 h-2 bg-orange-400 rounded-full mr-3"></span>Concept art</li>
                        </ul>
                    </div>
                </div>

                <!-- Video Generation -->
                <div class="service-card p-8 rounded-3xl relative group overflow-hidden">
                    <div class="absolute inset-0 bg-gradient-to-br from-orange-500/20 to-red-600/20 opacity-0 group-hover:opacity-100 transition-all duration-500"></div>
                    <div class="relative z-10">
                        <div class="w-20 h-20 bg-gradient-to-br from-orange-500 to-red-600 rounded-2xl flex items-center justify-center mb-6 glow-box group-hover:scale-110 transition-transform duration-500">
                            <i class="fas fa-video text-3xl text-white"></i>
                        </div>
                        <h3 class="text-2xl font-bold mb-4 text-white" data-translate="service-video-title">🎬 AI Video</h3>
                        <p class="text-gray-300 mb-6 text-lg leading-relaxed" data-translate="service-video-desc">
                            I generate videos using Kling AI, Runway, Luma, PikaLabs, Google Veo 3, Minimax. I select the optimal service for each task.
                        </p>
                        <ul class="text-gray-400 space-y-3">
                            <li data-translate="service-video-1" class="flex items-center"><span class="w-2 h-2 bg-orange-400 rounded-full mr-3"></span>Promotional videos</li>
                            <li data-translate="service-video-2" class="flex items-center"><span class="w-2 h-2 bg-red-400 rounded-full mr-3"></span>Character animation</li>
                            <li data-translate="service-video-3" class="flex items-center"><span class="w-2 h-2 bg-yellow-400 rounded-full mr-3"></span>Presentation videos</li>
                            <li data-translate="service-video-4" class="flex items-center"><span class="w-2 h-2 bg-pink-400 rounded-full mr-3"></span>Creative content</li>
                        </ul>
                    </div>
                </div>

                <!-- E-commerce -->
                <div class="service-card p-8 rounded-3xl relative group overflow-hidden">
                    <div class="absolute inset-0 bg-gradient-to-br from-indigo-500/20 to-blue-600/20 opacity-0 group-hover:opacity-100 transition-all duration-500"></div>
                    <div class="relative z-10">
                        <div class="w-20 h-20 bg-gradient-to-br from-indigo-500 to-blue-600 rounded-2xl flex items-center justify-center mb-6 glow-box group-hover:scale-110 transition-transform duration-500">
                            <i class="fas fa-shopping-cart text-3xl text-white"></i>
                        </div>
                        <h3 class="text-2xl font-bold mb-4 text-white" data-translate="service-ecommerce-title">🛒 E-commerce Creatives</h3>
                        <p class="text-gray-300 mb-6 text-lg leading-relaxed" data-translate="service-ecommerce-desc">
                            I create advertising creatives with real products. Training separate AI models on your products for maximum quality.
                        </p>
                        <ul class="text-gray-400 space-y-3">
                            <li data-translate="service-ecommerce-1" class="flex items-center"><span class="w-2 h-2 bg-indigo-400 rounded-full mr-3"></span>Product photos in various scenes</li>
                            <li data-translate="service-ecommerce-2" class="flex items-center"><span class="w-2 h-2 bg-blue-400 rounded-full mr-3"></span>Clothing on real people</li>
                            <li data-translate="service-ecommerce-3" class="flex items-center"><span class="w-2 h-2 bg-cyan-400 rounded-full mr-3"></span>Advertising banners</li>
                            <li data-translate="service-ecommerce-4" class="flex items-center"><span class="w-2 h-2 bg-purple-400 rounded-full mr-3"></span>Catalog images</li>
                        </ul>
                    </div>
                </div>

                <!-- Virtual Photoshoot -->
                <div class="service-card p-8 rounded-3xl relative group overflow-hidden">
                    <div class="absolute inset-0 bg-gradient-to-br from-purple-500/20 to-pink-600/20 opacity-0 group-hover:opacity-100 transition-all duration-500"></div>
                    <div class="relative z-10">
                        <div class="w-20 h-20 bg-gradient-to-br from-purple-500 to-pink-600 rounded-2xl flex items-center justify-center mb-6 glow-box group-hover:scale-110 transition-transform duration-500">
                            <i class="fas fa-camera text-3xl text-white"></i>
                        </div>
                        <h3 class="text-2xl font-bold mb-4 text-white" data-translate="service-photoshoot-title">📸 Virtual Photoshoots</h3>
                        <p class="text-gray-300 mb-6 text-lg leading-relaxed" data-translate="service-photoshoot-desc">
                            Training AI model on a specific person to create photos in different styles, locations and looks without a real photoshoot.
                        </p>
                        <ul class="text-gray-400 space-y-3">
                            <li data-translate="service-photoshoot-1" class="flex items-center"><span class="w-2 h-2 bg-purple-400 rounded-full mr-3"></span>Portraits in various styles</li>
                            <li data-translate="service-photoshoot-2" class="flex items-center"><span class="w-2 h-2 bg-pink-400 rounded-full mr-3"></span>Professional photos</li>
                            <li data-translate="service-photoshoot-3" class="flex items-center"><span class="w-2 h-2 bg-red-400 rounded-full mr-3"></span>Creative looks</li>
                            <li data-translate="service-photoshoot-4" class="flex items-center"><span class="w-2 h-2 bg-orange-400 rounded-full mr-3"></span>Social media content</li>
                        </ul>
                    </div>
                </div>

                <!-- Video Editing -->
                <div class="service-card p-8 rounded-3xl relative group overflow-hidden">
                    <div class="absolute inset-0 bg-gradient-to-br from-yellow-500/20 to-orange-600/20 opacity-0 group-hover:opacity-100 transition-all duration-500"></div>
                    <div class="relative z-10">
                        <div class="w-20 h-20 bg-gradient-to-br from-yellow-500 to-orange-600 rounded-2xl flex items-center justify-center mb-6 glow-box group-hover:scale-110 transition-transform duration-500">
                            <i class="fas fa-cut text-3xl text-white"></i>
                        </div>
                        <h3 class="text-2xl font-bold mb-4 text-white" data-translate="service-editing-title">✂️ Video Editing</h3>
                        <p class="text-gray-300 mb-6 text-lg leading-relaxed" data-translate="service-editing-desc">
                            Video editing and post-production using Adobe Premiere Pro, After Effects, and other industry-standard tools.
                        </p>
                        <ul class="text-gray-400 space-y-3">
                            <li data-translate="service-editing-1" class="flex items-center"><span class="w-2 h-2 bg-yellow-400 rounded-full mr-3"></span>AI content editing</li>
                            <li data-translate="service-editing-2" class="flex items-center"><span class="w-2 h-2 bg-orange-400 rounded-full mr-3"></span>Color correction & grading</li>
                            <li data-translate="service-editing-3" class="flex items-center"><span class="w-2 h-2 bg-red-400 rounded-full mr-3"></span>Motion graphics & effects</li>
                            <li data-translate="service-editing-4" class="flex items-center"><span class="w-2 h-2 bg-pink-400 rounded-full mr-3"></span>Post-production workflow</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Technologies Section -->
    <section class="py-20 bg-gradient-to-b from-black to-gray-900 relative">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
            <div class="text-center mb-16">
                <h2 class="text-4xl md:text-6xl font-bold mb-6 bg-gradient-to-r from-orange-400 to-red-500 bg-clip-text text-transparent" data-translate="tech-title">Technologies I Use</h2>
                <button class="admin-only epic-card px-6 py-3 rounded-2xl text-white hover:scale-110 transform transition-all duration-300" onclick="openTechModal()">
                    <i class="fas fa-plus mr-2"></i>Add Technology
                </button>
            </div>
            
            <div id="tech-grid" class="tech-grid">
                <!-- Technologies will be loaded here -->
            </div>
        </div>
    </section>

    <!-- Portfolio Section -->
    <section id="portfolio" class="py-20 bg-gradient-to-b from-gray-900 to-black relative">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
            <div class="text-center mb-16">
                <h2 class="text-4xl md:text-6xl font-bold mb-6 bg-gradient-to-r from-yellow-400 via-orange-500 to-red-500 bg-clip-text text-transparent" data-translate="portfolio-title">Portfolio</h2>
                <p class="text-xl md:text-2xl text-gray-300" data-translate="portfolio-subtitle">Examples of my work</p>
            </div>

            <!-- Portfolio Filter -->
            <div class="flex flex-wrap justify-center gap-4 mb-8">
                <button class="portfolio-filter active px-6 py-3 rounded-full bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300" data-filter="all" data-translate="filter-all">Всі роботи</button>
                <button class="portfolio-filter px-6 py-3 rounded-full bg-gray-800 text-gray-300 shadow-md hover:shadow-lg border-2 border-gray-600 hover:border-purple-400 hover:text-white transform hover:scale-105 transition-all duration-300" data-filter="avatars" data-translate="filter-avatars">👤 AI Аватари</button>
                <button class="portfolio-filter px-6 py-3 rounded-full bg-gray-800 text-gray-300 shadow-md hover:shadow-lg border-2 border-gray-600 hover:border-purple-400 hover:text-white transform hover:scale-105 transition-all duration-300" data-filter="image-generation" data-translate="filter-image-gen">🎨 Генерація зображень</button>
                <button class="portfolio-filter px-6 py-3 rounded-full bg-gray-800 text-gray-300 shadow-md hover:shadow-lg border-2 border-gray-600 hover:border-purple-400 hover:text-white transform hover:scale-105 transition-all duration-300" data-filter="video-creation" data-translate="filter-video-create">🎬 Генерація відео</button>
                <button class="portfolio-filter px-6 py-3 rounded-full bg-gray-800 text-gray-300 shadow-md hover:shadow-lg border-2 border-gray-600 hover:border-purple-400 hover:text-white transform hover:scale-105 transition-all duration-300" data-filter="ecommerce" data-translate="filter-ecommerce">🛒 E-commerce</button>
                <button class="portfolio-filter px-6 py-3 rounded-full bg-gray-800 text-gray-300 shadow-md hover:shadow-lg border-2 border-gray-600 hover:border-purple-400 hover:text-white transform hover:scale-105 transition-all duration-300" data-filter="virtual-shoots" data-translate="filter-virtual-shoots">📸 Віртуальні фотосесії</button>
            </div>
            
            <!-- Category Description and Media Type Filter -->
            <div id="category-info" class="mb-8 text-center">
                <!-- Category description will be shown here -->
            </div>
            
            <!-- Media Type Filter (only for categories with both photo and video) -->
            <div id="media-type-filter" class="flex justify-center gap-6 mb-8" style="display: none;">
                <label class="flex items-center space-x-2 cursor-pointer">
                    <input type="checkbox" id="show-photos" checked class="w-4 h-4 text-purple-600 bg-gray-800 border-gray-600 rounded focus:ring-purple-500 focus:ring-2">
                    <span class="text-white font-medium" data-translate="show-photos">📸 Показати фото</span>
                </label>
                <label class="flex items-center space-x-2 cursor-pointer">
                    <input type="checkbox" id="show-videos" checked class="w-4 h-4 text-purple-600 bg-gray-800 border-gray-600 rounded focus:ring-purple-500 focus:ring-2">
                    <span class="text-white font-medium" data-translate="show-videos">🎬 Показати відео</span>
                </label>
            </div>

            <!-- Portfolio Grid -->
            <div id="portfolio-grid" class="portfolio-grid">
                <!-- Portfolio items will be loaded here -->
            </div>
            
            <!-- Load More Button -->
            <div class="text-center mt-12" id="load-more-container" style="display: none;">
                <button id="load-more-btn" class="epic-card px-8 py-4 rounded-full font-bold text-lg text-white hover:scale-110 transform transition-all duration-300 relative overflow-hidden group shadow-lg hover:shadow-purple-500/50 bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600">
                    <span class="relative z-10">
                        <i class="fas fa-images mr-3"></i>
                        <span data-translate="load-more-portfolio">📸 Завантажити ще портфоліо</span>
                        <span id="load-more-count" class="ml-2 opacity-75"></span>
                    </span>
                </button>
                <p class="text-gray-400 text-sm mt-3" id="portfolio-status">
                    Показано <span id="shown-count">0</span> з <span id="total-count">0</span> робіт
                </p>
            </div>

            <!-- Add Portfolio Buttons (Admin Only) -->
            <div class="admin-only text-center mt-12 space-y-4">
                <p class="text-gray-600 mb-6" data-translate="portfolio-note">Upload your work here to show clients</p>
                
                <!-- Video Upload Tips -->
                <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6 text-left max-w-4xl mx-auto">
                    <h4 class="font-semibold text-yellow-800 mb-2">📹 Video Upload Tips:</h4>
                    <ul class="text-sm text-yellow-700 space-y-1">
                        <li><strong>YouTube:</strong> Use only copyright-free music or your own music</li>
                        <li><strong>Google Drive:</strong> Upload video → Share → "Anyone with link can view"</li>
                        <li><strong>Dropbox:</strong> Upload video → Create link → Works great for any video</li>
                        <li><strong>Alternative:</strong> Use free music from YouTube Audio Library or Pixabay</li>
                    </ul>
                </div>
                
                <div class="flex flex-wrap justify-center gap-4 max-w-4xl mx-auto">
                    <button onclick="openPortfolioModal('avatars')" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors text-sm">
                        <i class="fas fa-user-circle mr-2"></i>AI Avatars
                    </button>
                    <button onclick="openPortfolioModal('image-generation')" class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors text-sm">
                        <i class="fas fa-image mr-2"></i>Image Generation
                    </button>
                    <button onclick="openPortfolioModal('video-creation')" class="bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700 transition-colors text-sm">
                        <i class="fas fa-video mr-2"></i>Video Creation
                    </button>
                    <button onclick="openPortfolioModal('ecommerce')" class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors text-sm">
                        <i class="fas fa-shopping-cart mr-2"></i>E-commerce
                    </button>
                    <button onclick="openPortfolioModal('virtual-shoots')" class="bg-pink-600 text-white px-4 py-2 rounded-lg hover:bg-pink-700 transition-colors text-sm">
                        <i class="fas fa-camera mr-2"></i>Virtual Shoots
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="py-20 bg-gradient-to-b from-black to-gray-900 relative">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
            <div class="text-center mb-16">
                <h2 class="text-4xl md:text-6xl font-bold mb-6 bg-gradient-to-r from-green-400 to-blue-500 bg-clip-text text-transparent" data-translate="contact-title">Contact Me</h2>
                <div class="flex flex-col items-center mb-6">
                    <div class="w-24 h-24 mb-4 rounded-full overflow-hidden shadow-lg">
                        <img src="https://raw.githubusercontent.com/AndriiAICreator/andrii-ai-portfolio/main/icon.png" alt="Andrii" class="w-full h-full object-cover">
                    </div>
                    <p class="text-xl text-gray-600" data-translate="contact-subtitle">Ready to bring your ideas to life</p>
                </div>
            </div>

            <div class="max-w-4xl mx-auto">
                <!-- Contact Cards -->
                <div id="contact-grid" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Contacts will be loaded here -->
                </div>
                
                <!-- Admin Contact Management -->
                <div class="admin-only mt-12 text-center">
                    <button onclick="openContactModal()" class="bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors">
                        <i class="fas fa-plus mr-2"></i>Add Contact
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gradient-to-t from-black to-gray-900 text-white py-12 relative" style="max-width: 100vw; overflow: hidden; position: relative; transform: translateZ(0);">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
            <div class="text-center">
                <h3 class="text-3xl font-bold mb-6 bg-gradient-to-r from-purple-400 to-pink-500 bg-clip-text text-transparent">✨ Andrii AI Creator</h3>
                <p class="text-gray-400 mb-6" data-translate="footer-text">Bringing your ideas to life with artificial intelligence</p>
                <div id="footer-contacts" class="flex justify-center space-x-6">
                    <!-- Contacts will be loaded here -->
                </div>
                <div class="mt-8 pt-8 border-t border-gray-800 text-gray-400">
                    <p>&copy; 2025 Andrii AI Creator. <span data-translate="footer-rights">All rights reserved</span>.</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Lightbox -->
    <div id="lightbox" class="lightbox">
        <div id="lightbox-content" class="lightbox-content">
            <!-- Media content will be inserted here -->
        </div>
        <button id="lightbox-prev" class="lightbox-nav lightbox-prev">
            <i class="fas fa-chevron-left"></i>
        </button>
        <button id="lightbox-next" class="lightbox-nav lightbox-next">
            <i class="fas fa-chevron-right"></i>
        </button>
        <button id="lightbox-close" class="lightbox-close">
            <i class="fas fa-times"></i>
        </button>
        <div id="lightbox-counter" class="lightbox-counter">
            1 / 1
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification"></div>


    <script type="module">
      // ===== Ефект "Сяючий слід" (Sparkle Trail) =====
        const COLORS = ['#667eea', '#764ba2', '#f093fb', '#8b5cf6', '#ec4899', '#3b82f6'];
        let isThrottled = false;
        document.addEventListener('mousemove', (e) => {
            if (isThrottled) return;
            isThrottled = true;
            setTimeout(() => { isThrottled = false; }, 25);
            const sparkle = document.createElement('span');
            sparkle.classList.add('sparkle');
            const size = Math.random() * 8 + 4;
            sparkle.style.width = `${size}px`;
            sparkle.style.height = `${size}px`;
            const color = COLORS[Math.floor(Math.random() * COLORS.length)];
            sparkle.style.background = color;
            sparkle.style.boxShadow = `0 0 8px ${color}, 0 0 10px #ffffff`;
            const x = e.clientX + (Math.random() - 0.5) * 20;
            const y = e.clientY + (Math.random() - 0.5) * 20;
            sparkle.style.left = `${x}px`;
            sparkle.style.top = `${y}px`;
            document.body.appendChild(sparkle);
            sparkle.addEventListener('animationend', () => { sparkle.remove(); });
        });
        
        // GOOGLE APPS SCRIPT API CONFIGURATION
        const API_URL = 'https://script.google.com/macros/s/AKfycbz0Zaexc8XWf9KPQ6NMOnKhBUkW0Luh1aMDcgwP5mOX-Q17g87-WpahjybogY9PquhUYQ/exec';
        const ADMIN_PASSWORD = 'andrii2025';
        
        console.log('🌐 Online mode: using Google Apps Script API');
        
        let isAdminMode = false;
        let technologies = [];
        let portfolioItems = [];
        let contacts = [];
        
        const ITEMS_PER_PAGE = 12;
        let currentlyShown = 0;
        let filteredItems = [];
        let sortedOnce = false; // Флаг для контролю сортування

        const translations = {
           uk: {
                'nav-about': 'Про мене', 'nav-services': 'Послуги', 'nav-portfolio': 'Портфоліо', 'nav-contact': 'Контакти',
                'hero-greeting': 'Привіт, я', 'hero-subtitle': 'AI Creator | Творець штучного інтелекту',
                'hero-description': 'Створюю неймовірні AI аватари, генерую унікальні зображення та відео, озвучую контент на 70+ мовах. Втілюю ваші ідеї в життя за допомогою найсучасніших AI технологій.',
                'hero-services-btn': 'Мої послуги', 'hero-contact-btn': 'Зв\'язатися', 'about-title': 'Про мене',
                'about-description': 'Я спеціалізуюся на створенні високоякісного AI контенту для бізнесу та творчих проектів. Використовую найкращі AI інструменти для досягнення ваших цілей. Також займаюся професійним монтажем відео та пост-продакшном для підвищення рівня вашого контенту.',
                'about-innovation': 'Інновації', 'about-innovation-desc': 'Використовую найновіші AI технології',
                'about-creativity': 'Креативність', 'about-creativity-desc': 'Втілюю будь-які творчі ідеї',
                'about-speed': 'Швидкість', 'about-speed-desc': 'Швидке виконання проектів',
                'services-title': 'Мої Послуги', 'services-subtitle': 'Професійні AI рішення для вашого бізнесу',
                'service-avatars-title': '👤 AI Аватари', 'service-avatars-desc': 'Створюю реалістичні AI аватари для бізнесу, реклами, презентацій, соцмереж, ігор, додатків та будь-яких інших потреб.',
                'service-avatars-1': 'Корпоративні представники', 'service-avatars-2': 'Персонажі для соцмереж', 'service-avatars-3': 'Аватари для ігор та додатків', 'service-avatars-4': 'Віртуальні ведучі',
                'service-voice-title': '🎙️ AI Озвучка', 'service-voice-desc': 'Професійна озвучка текстів, аватарів та аудіокниг на 70+ мовах. Переклад та озвучка відео.',
                'service-voice-1': '70+ мов світу', 'service-voice-2': 'Озвучка аудіокниг', 'service-voice-3': 'Переклад відео', 'service-voice-4': 'Голоси для аватарів',
                'service-images-title': '🎨 Генерація зображень', 'service-images-desc': 'Створюю унікальні зображення за допомогою Midjourney, FLUX, Stable Diffusion, Krea та інших AI-сервісів.',
                'service-images-1': 'Реалістичні фотографії', 'service-images-2': 'Креативні ілюстрації', 'service-images-3': 'Мультиплікаційні персонажі', 'service-images-4': 'Концепт-арти',
                'service-video-title': '🎬 AI Відео', 'service-video-desc': 'Генерую відео за допомогою Kling AI, Runway, Luma, PikaLabs, Google Veo 3, Minimax. Підбираю оптимальний сервіс під кожне завдання.',
                'service-video-1': 'Рекламні ролики', 'service-video-2': 'Анімація персонажів', 'service-video-3': 'Відео для презентацій', 'service-video-4': 'Креативний контент',
                'service-ecommerce-title': '🛒 Креативи для E-commerce', 'service-ecommerce-desc': 'Створюю рекламні креативи з реальними товарами. Навчання окремих AI моделей на ваших товарах для максимальної якості.',
                'service-ecommerce-1': 'Фото товарів у різних сценах', 'service-ecommerce-2': 'Одяг на реальних людях', 'service-ecommerce-3': 'Рекламні банери', 'service-ecommerce-4': 'Зображення для каталогів',
                'service-photoshoot-title': '📸 Віртуальні фотосесії', 'service-photoshoot-desc': 'Навчання AI моделі на конкретній людині для створення фото у різних стилях, локаціях та образах без реальної фотосесії.',
                'service-photoshoot-1': 'Портрети у різних стилях', 'service-photoshoot-2': 'Професійні фотографії', 'service-photoshoot-3': 'Творчі образи', 'service-photoshoot-4': 'Контент для соціальних мереж',
                'service-editing-title': '✂️ Монтаж Відео', 'service-editing-desc': 'Монтаж та пост-продакшн відео з використанням Adobe Premiere Pro, After Effects та інших професійних інструментів.',
                'service-editing-1': 'Редагування AI контенту', 'service-editing-2': 'Корекція кольору', 'service-editing-3': 'Графіка та ефекти', 'service-editing-4': 'Пост-продакшн',
                'tech-title': 'Технології, які я використовую', 'portfolio-title': 'Портфоліо', 'portfolio-subtitle': 'Приклади моїх робіт',
                'contact-title': 'Зв\'яжіться зі мною', 'contact-subtitle': 'Готовий втілити ваші ідеї в життя',
                'footer-text': 'Втілюю ваші ідеї за допомогою штучного інтелекту', 'footer-rights': 'Всі права захищені',
                'load-more-portfolio': '📸 Завантажити ще',
                'filter-all': 'Всі роботи', 'filter-avatars': '👤 AI Аватари', 'filter-image-gen': '🎨 Генерація зображень',
                'filter-video-create': '🎬 Генерація відео', 'filter-ecommerce': '🛒 E-commerce', 'filter-virtual-shoots': '📸 Віртуальні фотосесії',
                'show-photos': '📸 Показати фото', 'show-videos': '🎬 Показати відео',
                'desc-avatars': 'Створюю реалістичних AI-ведучих та персонажів для вашого бізнесу. Вони ідеально підходять для навчальних відео, презентацій та рекламних кампаній у соцмережах. Ваш цифровий представник ніколи не втомлюється, не хворіє і готовий працювати 24/7, заощаджуючи ваш бюджет на зйомках та акторах.',
                'desc-image-generation': 'Перетворюю ваші найсміливіші ідеї на унікальні зображення. Потрібен кіт-космонавт у стилі Ван Гога чи фотореалістичний портрет неіснуючої людини? Я створю для вас будь-який арт: від ілюстрацій для сайту та соцмереж до складних концепт-артів для ігор та книг.',
                'desc-virtual-shoots': 'Створіть нескінченну кількість професійних фотографій для себе чи свого експерта без необхідності залишати дім. На основі кількох ваших знімків я навчаю персональну AI-модель, яка може згенерувати вас у будь-якому образі, стилі одягу та локації — від ділового портрета до фото з відпустки на Балі.',
                'desc-ecommerce': 'Професійні рекламні матеріали для вашого бренду "під ключ". Створюю як фотореалістичні зображення ваших товарів у будь-якому оточенні, так і динамічні відеокреативи для соцмереж та промо-кампаній. Покажіть ваш продукт на моделях, в екзотичних локаціях чи в дії — без залучення знімальної групи та фотостудії.',
                'desc-video-creation': 'Втілюю будь-які творчі відео-ідеї. Це може бути унікальне відео-привітання для близької людини, анімація вигаданих персонажів для вашого блогу чи каналу, або просто красиве, атмосферне відео на будь-яку тему — від космосу до фентезі. Ваша фантазія — єдине обмеження.'
            },
            en: {
                'nav-about': 'About', 'nav-services': 'Services', 'nav-portfolio': 'Portfolio', 'nav-contact': 'Contact',
                'hero-greeting': 'Hi, I\'m', 'hero-subtitle': 'AI Creator | Artificial Intelligence Creator',
                'hero-description': 'I create incredible AI avatars, generate unique images and videos, voice content in 70+ languages. I bring your ideas to life using cutting-edge AI technologies.',
                'hero-services-btn': 'My Services', 'hero-contact-btn': 'Get in Touch', 'about-title': 'About Me',
                'about-description': 'I specialize in creating high-quality AI content for business and creative projects. I use the best AI tools to achieve your goals. I also do professional video editing and post-production to bring your content to the next level.',
                'about-innovation': 'Innovation', 'about-innovation-desc': 'Using the latest AI technologies',
                'about-creativity': 'Creativity', 'about-creativity-desc': 'Bringing any creative ideas to life',
                'about-speed': 'Speed', 'about-speed-desc': 'Fast project delivery',
                'services-title': 'My Services', 'services-subtitle': 'Professional AI solutions for your business',
                'service-avatars-title': '👤 AI Avatars', 'service-avatars-desc': 'I create realistic AI avatars for business, advertising, presentations, social media, games, apps and any other needs.',
                'service-avatars-1': 'Corporate representatives', 'service-avatars-2': 'Social media characters', 'service-avatars-3': 'Gaming and app avatars', 'service-avatars-4': 'Virtual hosts',
                'service-voice-title': '🎙️ AI Voice', 'service-voice-desc': 'Professional voiceover for texts, avatars and audiobooks in 70+ languages. Video translation and voiceover.',
                'service-voice-1': '70+ world languages', 'service-voice-2': 'Audiobook narration', 'service-voice-3': 'Video translation', 'service-voice-4': 'Avatar voices',
                'service-images-title': '🎨 Image Generation', 'service-images-desc': 'I create unique images using Midjourney, FLUX, Stable Diffusion, Krea and other AI services.',
                'service-images-1': 'Realistic photographs', 'service-images-2': 'Creative illustrations', 'service-images-3': 'Cartoon characters', 'service-images-4': 'Concept art',
                'service-video-title': '🎬 AI Video', 'service-video-desc': 'I generate videos using Kling AI, Runway, Luma, PikaLabs, Google Veo 3, Minimax. I select the optimal service for each task.',
                'service-video-1': 'Promotional videos', 'service-video-2': 'Character animation', 'service-video-3': 'Presentation videos', 'service-video-4': 'Creative content',
                'service-ecommerce-title': '🛒 E-commerce Creatives', 'service-ecommerce-desc': 'I create advertising creatives with real products. Training separate AI models on your products for maximum quality.',
                'service-ecommerce-1': 'Product photos in various scenes', 'service-ecommerce-2': 'Clothing on real people', 'service-ecommerce-3': 'Advertising banners', 'service-ecommerce-4': 'Catalog images',
                'service-photoshoot-title': '📸 Virtual Photoshoots', 'service-photoshoot-desc': 'Training AI model on a specific person to create photos in different styles, locations and looks without a real photoshoot.',
                'service-photoshoot-1': 'Portraits in various styles', 'service-photoshoot-2': 'Professional photos', 'service-photoshoot-3': 'Creative looks', 'service-photoshoot-4': 'Social media content',
                'service-editing-title': '✂️ Video Editing', 'service-editing-desc': 'Video editing and post-production using Adobe Premiere Pro, After Effects, and other industry-standard tools.',
                'service-editing-1': 'AI content editing', 'service-editing-2': 'Color correction & grading', 'service-editing-3': 'Motion graphics & effects', 'service-editing-4': 'Post-production workflow',
                'tech-title': 'Technologies I Use', 'portfolio-title': 'Portfolio', 'portfolio-subtitle': 'Examples of my work',
                'contact-title': 'Contact Me', 'contact-subtitle': 'Ready to bring your ideas to life',
                'load-more-portfolio': '📸 Load More Portfolio', 'footer-text': 'Bringing your ideas to life with artificial intelligence',
                'footer-rights': 'All rights reserved',
                'filter-all': 'All Works', 'filter-avatars': '👤 AI Avatars', 'filter-image-gen': '🎨 Image Generation',
                'filter-video-create': '🎬 Video Generation', 'filter-ecommerce': '🛒 E-commerce', 'filter-virtual-shoots': '📸 Virtual Shoots',
                'show-photos': '📸 Show Photos', 'show-videos': '🎬 Show Videos',
                'desc-avatars': 'I create realistic AI hosts and characters for your business. They are perfect for educational videos, presentations and advertising campaigns on social media. Your digital representative never gets tired, doesn\'t get sick and is ready to work 24/7, saving your budget on filming and actors.',
                'desc-image-generation': 'I turn your wildest ideas into unique images. Need a space cat in Van Gogh style or a photorealistic portrait of a non-existent person? I will create any art for you: from illustrations for websites and social media to complex concept art for games and books.',
                'desc-virtual-shoots': 'Create an endless number of professional photos for yourself or your expert without having to leave home. Based on a few of your shots, I train a personal AI model that can generate you in any look, clothing style and location - from a business portrait to vacation photos in Bali.',
                'desc-ecommerce': 'Professional advertising materials for your brand "turnkey". I create both photorealistic images of your products in any environment, and dynamic video creatives for social media and promo campaigns. Show your product on models, in exotic locations or in action - without involving a film crew and photo studio.',
                'desc-video-creation': 'I bring any creative video ideas to life. It can be a unique video greeting for a loved one, animation of fictional characters for your blog or channel, or just a beautiful, atmospheric video on any topic - from space to fantasy. Your imagination is the only limit.'
            }
        };

        let currentLang = localStorage.getItem('language') || 'en';
        
        function updateLanguage(lang) {
            currentLang = lang;
            localStorage.setItem('language', lang);
            document.getElementById('lang-en').classList.toggle('bg-blue-500', lang === 'en');
            document.getElementById('lang-en').classList.toggle('text-white', lang === 'en');
            document.getElementById('lang-en').classList.toggle('text-gray-600', lang !== 'en');
            document.getElementById('lang-ua').classList.toggle('bg-blue-500', lang === 'uk');
            document.getElementById('lang-ua').classList.toggle('text-white', lang === 'uk');
            document.getElementById('lang-ua').classList.toggle('text-gray-600', lang !== 'uk');
            document.documentElement.lang = lang === 'uk' ? 'uk' : 'en';
            document.querySelectorAll('[data-translate]').forEach(element => {
                const key = element.getAttribute('data-translate');
                if (translations[lang] && translations[lang][key]) {
                    if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                        element.placeholder = translations[lang][key];
                    } else {
                        element.textContent = translations[lang][key];
                    }
                }
            });
            const titles = {
                uk: 'Andrii - AI Creator | Професійні AI послуги',
                en: 'Andrii - AI Creator | Professional AI Services'
            };
            const descriptions = {
                uk: 'Професійні AI послуги: аватари, озвучка, генерація зображень та відео, e-commerce креативи, віртуальні фотосесії',
                en: 'Professional AI services: avatars, voiceover, image and video generation, e-commerce creatives, virtual photoshoots'
            };
            document.title = titles[lang];
            document.querySelector('meta[name="description"]').content = descriptions[lang];
            
            // Оновлюємо опис категорії при зміні мови
            updateCategoryInfo();
            
            document.body.classList.add('fade-in');
            setTimeout(() => document.body.classList.remove('fade-in'), 500);
        }
        
        document.getElementById('lang-en').addEventListener('click', () => updateLanguage('en'));
        document.getElementById('lang-ua').addEventListener('click', () => updateLanguage('uk'));

        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.classList.add('show');
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        function updateApiStatus(status, message = '') {
            const indicator = document.getElementById('api-status');
            indicator.className = `api-status ${status}`;
            switch (status) {
                case 'online': indicator.innerHTML = '<i class="fas fa-cloud-upload-alt"></i> Connected'; break;
                case 'offline': indicator.innerHTML = '<i class="fas fa-cloud-exclamation"></i> Offline'; break;
                case 'loading': indicator.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Loading...'; break;
                case 'error': indicator.innerHTML = '<i class="fas fa-exclamation-triangle"></i> Error'; break;
            }
        }

        async function callAPI(action, data = {}, method = 'GET') {
            try {
                updateApiStatus('loading');
                console.log('🌐 API Call:', action);
                const formData = new FormData();
                formData.append('action', action);
                if (isAdminMode && method === 'POST') {
                    formData.append('password', ADMIN_PASSWORD);
                }
                if (Object.keys(data).length > 0) {
                    formData.append('data', JSON.stringify(data));
                }
                const response = await fetch(API_URL, { method: 'POST', body: formData });
                const result = await response.json();
                console.log('📥 API Response:', result);
                if (result.status === 200) {
                    updateApiStatus('online');
                    return result.data;
                } else {
                    throw new Error(result.data?.error || 'API Error');
                }
            } catch (error) {
                console.error('❌ API Error:', error);
                updateApiStatus('offline');
                throw error;
            }
        }

        async function loadDataFromAPI() {
            try {
                console.log('📡 Loading data...');
                const response = await fetch(API_URL + '?action=getAllData', { method: 'GET' });
                const result = await response.json();
                console.log('📊 Raw API Response:', result);
                if (result.status === 200 && result.data) {
                    portfolioItems = result.data.portfolioItems || [];
                    technologies = result.data.technologies || [];
                    contacts = result.data.contacts || [];
                    
                    // Автоматично видаляємо дублікати при завантаженні
                    const hadDuplicates = removeDuplicates();
                    if (hadDuplicates) {
                        console.log('🔄 Auto-saving after duplicate removal...');
                        await saveDataToAPI();
                    }
                    
                    console.log('✅ Loaded:', portfolioItems.length, 'portfolio,', technologies.length, 'tech,', contacts.length, 'contacts');
                    updateApiStatus('online');
                    return result.data;
                } else {
                    throw new Error('Invalid API response');
                }
            } catch (error) {
                console.error('❌ Load error:', error);
                updateApiStatus('offline');
                portfolioItems = [];
                technologies = [
                    { name: 'Midjourney', emoji: '🎨' }, { name: 'FLUX', emoji: '⚡' }, { name: 'Stable Diffusion', emoji: '🔬' }
                ];
                contacts = [
                    { platform: 'email', label: 'andrii.aicreator@gmail.com', url: 'mailto:andrii.aicreator@gmail.com', icon: 'fas fa-envelope' }
                ];
                return { portfolioItems, technologies, contacts };
            }
        }

        async function saveDataToAPI() {
            if (!isAdminMode) return;
            try {
                console.log('💾 Saving to Google Apps Script API...');
                const data = { portfolioItems, technologies, contacts };
                await callAPI('saveAllData', data, 'POST');
                console.log('✅ Data saved to API');
                if (isAdminMode) {
                    showNotification('✅ Дані збережено в Google Sheets!', 'success');
                }
            } catch (error) {
                console.error('❌ API save error:', error);
                throw error;
            }
        }

        async function uploadFileToAPI(file, category) {
            try {
                showNotification('📤 Завантажую файл до Google Drive...', 'success');
                const base64 = await fileToBase64(file);
                const formData = new FormData();
                formData.append('action', 'uploadFile');
                formData.append('password', ADMIN_PASSWORD);
                formData.append('file', base64.split(',')[1]);
                formData.append('filename', file.name);
                formData.append('mimeType', file.type);
                formData.append('category', category);
                const response = await fetch(API_URL, { method: 'POST', body: formData });
                const result = await response.json();
                if (result.status !== 200) {
                    throw new Error(result.data?.error || 'Upload failed');
                }
                console.log('📤 File uploaded to Google Drive:', result.data.url);
                showNotification('✅ Файл успішно завантажено до Google Drive!', 'success');
                return result.data.url;
            } catch (error) {
                console.error('❌ Error uploading file:', error);
                showNotification('❌ Помилка завантаження файлу', 'error');
                throw error;
            }
        }

        function fileToBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = () => resolve(reader.result);
                reader.onerror = error => reject(error);
            });
        }

        async function saveData() { await saveDataToAPI(); }

        window.removeContact = function(index) {
            if (confirm('Are you sure you want to remove this contact?')) {
                contacts.splice(index, 1);
                saveData();
                renderContacts();
                showNotification('Contact removed successfully', 'success');
            }
        }

        function getContactIcon(platform) {
            const icons = { email: 'fas fa-envelope', telegram: 'fab fa-telegram', instagram: 'fab fa-instagram', tiktok: 'fab fa-tiktok', linkedin: 'fab fa-linkedin', youtube: 'fab fa-youtube', twitter: 'fab fa-twitter', whatsapp: 'fab fa-whatsapp', facebook: 'fab fa-facebook', discord: 'fab fa-discord', phone: 'fas fa-phone', website: 'fas fa-globe' };
            return icons[platform] || 'fas fa-link';
        }

        function toggleAdminMode(enable = null) {
            isAdminMode = enable !== null ? enable : !isAdminMode;
            if (isAdminMode) {
                document.body.classList.add('admin-mode');
                localStorage.setItem('adminMode', 'true');
                showNotification('⚙️ Адмін режим', 'success');
            } else {
                document.body.classList.remove('admin-mode');
                localStorage.removeItem('adminMode');
                showNotification('👤 Режим користувача', 'success');
            }
        }

        window.openTechModal = function() { document.getElementById('tech-modal').classList.add('active'); }
        window.closeTechModal = function() { document.getElementById('tech-modal').classList.remove('active'); document.getElementById('tech-form').reset(); }
        window.openPortfolioModal = function(category = '') { if (category) { document.getElementById('portfolio-category').value = category; } document.getElementById('portfolio-modal').classList.add('active'); }
        window.closePortfolioModal = function() { document.getElementById('portfolio-modal').classList.remove('active'); document.getElementById('portfolio-form').reset(); }
        window.openPasswordModal = function() { document.getElementById('password-modal').classList.add('active'); }
        window.closePasswordModal = function() { document.getElementById('password-modal').classList.remove('active'); document.getElementById('password-form').reset(); }
        window.openContactModal = function() { document.getElementById('contact-modal').classList.add('active'); }
        window.closeContactModal = function() { document.getElementById('contact-modal').classList.remove('active'); document.getElementById('contact-form-modal').reset(); }

        function renderTechnologies() {
            const grid = document.getElementById('tech-grid');
            grid.innerHTML = '';
            
            // Створюємо DocumentFragment для кращої продуктивності
            const fragment = document.createDocumentFragment();
            
            technologies.forEach((tech, index) => {
                const techDiv = document.createElement('div');
                techDiv.className = 'epic-card text-center p-6 rounded-2xl hover:scale-110 transform transition-all duration-500 relative group tech-card overflow-hidden';
                techDiv.style.animationDelay = `${index * 50}ms`; // Зменшено з 100ms до 50ms
                const gradients = ['from-purple-500 to-pink-500', 'from-blue-500 to-cyan-500', 'from-green-500 to-teal-500', 'from-orange-500 to-red-500', 'from-indigo-500 to-purple-500', 'from-pink-500 to-rose-500'];
                const randomGradient = gradients[index % gradients.length];
                const bgColors = ['from-purple-500/15 to-pink-500/15', 'from-blue-500/15 to-cyan-500/15', 'from-green-500/15 to-teal-500/15', 'from-orange-500/15 to-red-500/15', 'from-indigo-500/15 to-purple-500/15', 'from-pink-500/15 to-rose-500/15']; // Зменшено непрозорість з /20 до /15
                const randomBgColor = bgColors[index % bgColors.length];
                techDiv.innerHTML = `<div class="absolute inset-0 bg-gradient-to-br ${randomBgColor} opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div> <div class="relative z-10"> <div class="w-16 h-16 bg-gradient-to-br ${randomGradient} rounded-2xl flex items-center justify-center mx-auto mb-4 glow-box group-hover:scale-110 transition-transform duration-300"> <div class="text-2xl">${tech.emoji}</div> </div> <h4 class="font-bold text-white text-lg group-hover:text-cyan-300 transition-colors duration-200">${tech.name}</h4> </div> <button class="admin-only absolute top-2 right-2 bg-red-500 text-white rounded-full w-8 h-8 text-sm hover:bg-red-600 hover:scale-110 transition-all duration-200 flex items-center justify-center z-20" onclick="removeTechnology(${index})" style="display: none;">×</button>`;
                fragment.appendChild(techDiv);
            });
            
            // Додаємо всі елементи одразу
            grid.appendChild(fragment);
            
            // Оптимізована анімація появи з використанням Intersection Observer для кращої продуктивності
            const observerOptions = { threshold: 0.1, rootMargin: '50px' };
            const techObserver = new IntersectionObserver((entries) => {
                entries.forEach((entry, index) => {
                    if (entry.isIntersecting) {
                        setTimeout(() => {
                            entry.target.style.opacity = '1';
                            entry.target.style.transform = 'translateY(0) scale(1)';
                        }, index * 60); // Зменшено до 60ms
                        techObserver.unobserve(entry.target);
                    }
                });
            }, observerOptions);
            
            document.querySelectorAll('.tech-card').forEach(card => {
                techObserver.observe(card);
            });
        }

        function renderContacts() {
            const contactGrid = document.getElementById('contact-grid');
            contactGrid.innerHTML = '';
            contacts.forEach((contact, index) => {
                const contactDiv = document.createElement('div');
                contactDiv.className = 'epic-card p-8 rounded-3xl hover:scale-105 transform transition-all duration-500 relative group';
                const platformColors = { email: 'text-blue-600', telegram: 'text-blue-500', instagram: 'text-pink-600', tiktok: 'text-black', linkedin: 'text-blue-700', youtube: 'text-red-600', twitter: 'text-blue-400', whatsapp: 'text-green-600', facebook: 'text-blue-800', discord: 'text-purple-600', phone: 'text-green-600', website: 'text-gray-600' };
                contactDiv.innerHTML = `<a href="${contact.url}" target="_blank" rel="noopener noreferrer" class="block text-center group h-full"> <div class="w-20 h-20 mx-auto mb-6 ${platformColors[contact.platform] || 'text-gray-600'} group-hover:scale-125 group-hover:rotate-12 transition-all duration-500 bg-gradient-to-br from-white/10 to-white/5 rounded-2xl flex items-center justify-center glow-box"> <i class="${contact.icon} text-5xl"></i> </div> <h3 class="font-bold text-xl mb-3 text-white group-hover:text-cyan-400 transition-colors"> ${contact.platform.charAt(0).toUpperCase() + contact.platform.slice(1)} </h3> <p class="text-gray-300 text-lg">${contact.label}</p> </a> <button class="admin-only absolute top-3 right-3 bg-red-500 text-white rounded-full w-8 h-8 text-sm hover:bg-red-600 flex items-center justify-center" onclick="removeContact(${index})" style="display: none;">×</button>`;
                contactGrid.appendChild(contactDiv);
            });
            const footerContacts = document.getElementById('footer-contacts');
            footerContacts.innerHTML = '';
            contacts.forEach(contact => {
                const link = document.createElement('a');
                link.href = contact.url;
                link.target = '_blank';
                link.rel = 'noopener noreferrer';
                link.className = 'text-gray-400 hover:text-white transition-colors';
                link.innerHTML = `<i class="${contact.icon} text-2xl"></i>`;
                footerContacts.appendChild(link);
            });
        }

        let currentLightboxIndex = 0;
        let lightboxItems = [];

        function openLightbox(filteredIndex) {
            // Використовуємо вже готовий відфільтрований масив
            lightboxItems = filteredItems;
            currentLightboxIndex = filteredIndex;
            
            if (currentLightboxIndex < 0 || currentLightboxIndex >= lightboxItems.length) {
                console.error("❌ Invalid lightbox index:", filteredIndex);
                currentLightboxIndex = 0;
            }
            
            console.log(`🖼️ Opening lightbox for filtered index ${filteredIndex} of ${lightboxItems.length} items`);
            
            updateLightboxContent();
            updateLightboxNavigation();
            document.getElementById('lightbox').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeLightbox() { document.getElementById('lightbox').classList.remove('active'); document.body.style.overflow = 'auto'; }
        
        function updateLightboxContent() {
            const item = lightboxItems[currentLightboxIndex];
            const content = document.getElementById('lightbox-content');
            if (!item) return;
            content.innerHTML = createMediaContent(item, true);
        }
        
        function updateLightboxNavigation() {
            const counter = document.getElementById('lightbox-counter');
            const prevBtn = document.getElementById('lightbox-prev');
            const nextBtn = document.getElementById('lightbox-next');
            if (counter) { counter.textContent = `${currentLightboxIndex + 1} / ${lightboxItems.length}`; }
            if (lightboxItems.length <= 1) {
                if (prevBtn) prevBtn.style.display = 'none';
                if (nextBtn) nextBtn.style.display = 'none';
                if (counter) counter.style.display = 'none';
            } else {
                if (prevBtn) prevBtn.style.display = 'flex';
                if (nextBtn) nextBtn.style.display = 'flex';
                if (counter) counter.style.display = 'block';
            }
        }

        function nextLightboxItem() {
            if (lightboxItems.length <= 1) return;
            currentLightboxIndex = (currentLightboxIndex + 1) % lightboxItems.length;
            updateLightboxContent();
            updateLightboxNavigation();
        }

        function prevLightboxItem() {
            if (lightboxItems.length <= 1) return;
            currentLightboxIndex = (currentLightboxIndex - 1 + lightboxItems.length) % lightboxItems.length;
            updateLightboxContent();
            updateLightboxNavigation();
        }

        function getMediaType(item) {
            if (item.mediaType) { return item.mediaType === 'photo' ? 'photos' : 'videos'; }
            const url = item.url || item;
            if (url.match(/\.(jpg|jpeg|png|gif|webp|svg)$/i)) return 'photos';
            if (url.includes('youtube.com') || url.includes('youtu.be') || url.includes('drive.google.com') || url.includes('dropbox.com') || url.match(/\.(mp4|mov|webm|avi|mkv)$/i)) return 'videos';
            return 'photos';
        }
        
        function createMediaContent(item, isLightbox = false) {
            const url = item.url || '';
            const youtubeRegex = /(?:youtube\.com\/(?:watch\?v=|embed\/|shorts\/)|youtu\.be\/)([a-zA-Z0-9_-]{11})/;
            const youtubeMatch = url.match(youtubeRegex);
            if (youtubeMatch && youtubeMatch[1]) {
                const videoId = youtubeMatch[1];
                const embedSrc = `https://www.youtube.com/embed/${videoId}?controls=1&rel=0${isLightbox ? '&autoplay=1' : ''}`;
                return `<iframe loading="lazy" width="100%" height="${isLightbox ? '95%' : '280'}" src="${embedSrc}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen style="border-radius: ${isLightbox ? '8px' : '20px 20px 0 0'};"></iframe>`;
            }
            const driveRegex = /drive\.google\.com\/(?:file\/d\/|open\?id=)([a-zA-Z0-9-_]+)/;
            const driveMatch = url.match(driveRegex);
            if (driveMatch && driveMatch[1]) {
                const fileId = driveMatch[1];
                if (item.mediaType === 'video') {
                    const embedSrc = `https://drive.google.com/file/d/${fileId}/preview`;
                    return `<iframe loading="lazy" width="100%" height="${isLightbox ? '95%' : '280'}" src="${embedSrc}" frameborder="0" allowfullscreen style="border-radius: ${isLightbox ? '8px' : '20px 20px 0 0'};"></iframe>`;
                }
                if (item.mediaType === 'photo') {
                    const baseUrl = `https://drive.google.com/thumbnail?id=${fileId}&sz=`;
                    // Оптимізовано розміри зображень: зменшено якість для галереї, але збережено для lightbox
                    return `<img loading="lazy" src="${baseUrl}${isLightbox ? 'w1200' : 'w600'}" alt="Portfolio item" style="width: 100%; height: auto; object-fit: cover;">`;
                }
            }
            if (url.includes('dropbox.com')) {
                let directUrl = url.replace('www.dropbox.com', 'dl.dropboxusercontent.com').replace('?dl=0', '');
                return `<video width="100%" height="${isLightbox ? '95%' : '280'}" controls style="background:black; border-radius: ${isLightbox ? '8px' : '20px 20px 0 0'};" preload="metadata"><source src="${directUrl}" type="video/mp4"></video>`;
            }
            if (url.match(/\.(mp4|mov|webm)$/i)) {
                return `<video width="100%" height="${isLightbox ? '95%' : '280'}" controls style="background:black; border-radius: ${isLightbox ? '8px' : '20px 20px 0 0'};" preload="metadata"><source src="${url}"></video>`;
            }
            if (url.match(/\.(jpg|jpeg|png|gif|webp|svg)$/i)) {
                return `<img loading="lazy" src="${url}" alt="Portfolio item" style="width: 100%; height: auto; object-fit: cover;">`;
            }
            return `<div class="h-48 bg-gradient-to-br from-gray-700 to-gray-900 flex items-center justify-center text-white p-4"><div class="text-center"><i class="fas fa-exclamation-triangle text-4xl mb-2 text-yellow-400"></i><p class="mb-2 text-sm">Не вдалося відобразити медіа. Перевірте посилання або права доступу.</p><a href="${url}" target="_blank" class="bg-blue-500 text-white px-3 py-1 rounded-lg text-xs hover:bg-blue-600 transition-colors">Відкрити в новій вкладці</a></div></div>`;
        }

        // ЗАМІНИТИ НА ЦЮ ВЕРСІЮ
        function renderPortfolio(reset = false) {
            const grid = document.getElementById('portfolio-grid');
            if (reset) {
                grid.innerHTML = '';
                currentlyShown = 0;
            }
            
            applyCurrentFilters();
            
            // Сортування тепер відбувається завжди для відфільтрованих елементів. Це просто і надійно.
            filteredItems.sort((a, b) => new Date(b.uploadedAt) - new Date(a.uploadedAt));
            
            if (filteredItems.length === 0) {
                grid.innerHTML = `<div style="grid-column: 1 / -1; text-align: center; padding: 3rem 0;"><i class="fas fa-folder-open text-6xl text-gray-300 mb-4"></i><p class="text-gray-500 text-lg">Нічого не знайдено</p></div>`;
                updateLoadMoreButton();
                return;
            }
            
            const itemsToShow = filteredItems.slice(currentlyShown, currentlyShown + ITEMS_PER_PAGE);
            const fragment = document.createDocumentFragment();
            
            itemsToShow.forEach((item, relativeIndex) => {
                const filteredIndex = currentlyShown + relativeIndex;
                const mediaContent = createMediaContent(item);
                const itemDiv = document.createElement('div');
                itemDiv.className = `portfolio-item cursor-pointer relative ${item.category} ${getMediaType(item)}`;
                itemDiv.dataset.index = filteredIndex;
                itemDiv.style.animationDelay = `${relativeIndex * 60}ms`;
                
                itemDiv.innerHTML = `${mediaContent}<button class="delete-btn absolute top-2 right-2 bg-red-500 text-white rounded-full w-8 h-8 text-sm hover:bg-red-600 flex items-center justify-center admin-only" onclick="removePortfolioItem(event, ${filteredIndex})" style="display: none;">×</button>`;
                itemDiv.addEventListener('click', (e) => {
                    if (e.target.closest('.delete-btn')) return;
                    openLightbox(filteredIndex);
                });
                fragment.appendChild(itemDiv);
            });
            
            grid.appendChild(fragment);
            currentlyShown += itemsToShow.length;
            
            requestAnimationFrame(() => {
                const newItems = grid.querySelectorAll('.portfolio-item:not(.visible)');
                newItems.forEach((item, index) => {
                    setTimeout(() => {
                        item.classList.add('visible');
                    }, index * 60);
                });
            });
            
            updateLoadMoreButton();
        }
        
        function applyCurrentFilters() {
            const categoryFilter = document.querySelector('.portfolio-filter.active')?.dataset.filter || 'all';
            const showPhotos = document.getElementById('show-photos')?.checked ?? true;
            const showVideos = document.getElementById('show-videos')?.checked ?? true;
            
            console.log('🔧 Applying filters:', { categoryFilter, showPhotos, showVideos });
            
            // Створюємо Set для відслідковування унікальних елементів
            const seen = new Set();
            
            filteredItems = portfolioItems.filter(item => {
                // Фільтр по категорії
                if (categoryFilter !== 'all' && item.category !== categoryFilter) return false;
                
                // Фільтр по типу медіа (тільки для категорій з фото та відео)
                if (categoryFilter === 'avatars' || categoryFilter === 'ecommerce') {
                    const mediaType = getMediaType(item);
                    if (mediaType === 'photos' && !showPhotos) return false;
                    if (mediaType === 'videos' && !showVideos) return false;
                }
                
                // Перевірка на унікальність (запобігаємо дублям у filteredItems)
                const uniqueKey = `${item.url}_${item.category}_${item.uploadedAt}`;
                if (seen.has(uniqueKey)) {
                    console.log('🗑️ Filtered out duplicate in applyCurrentFilters:', item.url.substring(0, 30));
                    return false;
                }
                seen.add(uniqueKey);
                
                return true;
            });
            
            console.log('✅ Filtered items:', filteredItems.length, 'from', portfolioItems.length);
        }
        
        function updateLoadMoreButton() {
            const loadMoreContainer = document.getElementById('load-more-container');
            const loadMoreCount = document.getElementById('load-more-count');
            const shownCount = document.getElementById('shown-count');
            const totalCount = document.getElementById('total-count');
            if (!loadMoreContainer) return;
            const remaining = filteredItems.length - currentlyShown;
            if (shownCount) shownCount.textContent = currentlyShown;
            if (totalCount) totalCount.textContent = filteredItems.length;
            if (remaining > 0) {
                loadMoreContainer.style.display = 'block';
                if (loadMoreCount) { loadMoreCount.textContent = `(+${Math.min(remaining, ITEMS_PER_PAGE)})`; }
            } else {
                loadMoreContainer.style.display = 'none';
            }
        }

        window.removeTechnology = function(index) { technologies.splice(index, 1); saveData(); renderTechnologies(); showNotification('Technology removed', 'success'); }
        // Функція для видалення дублікатів
        // ЗАМІНИТИ НА ЦЮ ВЕРСІЮ
        function removeDuplicates() {
            console.log('🔍 Checking for duplicates based on URL...');
            const seenUrls = new Set();
            const originalCount = portfolioItems.length;

            // Фільтруємо масив, залишаючи тільки елементи з унікальними URL
            portfolioItems = portfolioItems.filter(item => {
                // Перевіряємо, чи є URL і чи ми його вже бачили
                if (!item.url || seenUrls.has(item.url)) {
                    console.log(`🗑️ Removing duplicate URL:`, item.url);
                    return false; // Видаляємо, якщо URL порожній або вже був
                }
                seenUrls.add(item.url);
                return true; // Залишаємо, якщо URL унікальний
            });

            const removedCount = originalCount - portfolioItems.length;
            if (removedCount > 0) {
                console.log(`✅ Removed ${removedCount} duplicate items.`);
                showNotification(`Видалено ${removedCount} дублікатів`, 'success');
                return true; // Повертаємо true, щоб вказати, що були зміни
            } else {
                console.log('✅ No duplicates found.');
                return false;
            }
        }

        window.removePortfolioItem = function(event, filteredIndex) {
            event.stopPropagation(); // Зупиняємо клік, щоб не відкрився лайтбокс
            
            if (confirm('Ви впевнені, що хочете видалити цей елемент?')) {
                // Беремо елемент з відфільтрованого списку
                const itemToRemove = filteredItems[filteredIndex];
                if (!itemToRemove) {
                    console.error('❌ Item not found at filtered index:', filteredIndex);
                    showNotification('Помилка: елемент не знайдено', 'error');
                    return;
                }
                
                console.log('🗑️ Removing item from filtered index', filteredIndex, ':', itemToRemove.url?.substring(0, 50));
                
                // Знаходимо цей же елемент в основному масиві portfolioItems
                const mainIndex = portfolioItems.findIndex(pItem => 
                    pItem.url === itemToRemove.url && 
                    pItem.uploadedAt === itemToRemove.uploadedAt &&
                    pItem.category === itemToRemove.category
                );
                
                if (mainIndex !== -1) {
                    console.log('🗑️ Found in main array at index', mainIndex, 'removing...');
                    portfolioItems.splice(mainIndex, 1);
                    saveData();
                    renderPortfolio(true); // Повне перезавантаження
                    showNotification('Елемент видалено', 'success');
                } else {
                    console.error('❌ Could not find item in main portfolioItems array');
                    showNotification('Помилка видалення. Спробуйте оновити сторінку.', 'error');
                }
            }
        }

        const adminToggle = document.getElementById('admin-toggle');
        if (adminToggle) { adminToggle.addEventListener('click', function() { if (!isAdminMode) { openPasswordModal(); } else { toggleAdminMode(false); } }); }

        const passwordForm = document.getElementById('password-form');
        if (passwordForm) { passwordForm.addEventListener('submit', function(e) { e.preventDefault(); const password = document.getElementById('admin-password').value; if (password === ADMIN_PASSWORD) { toggleAdminMode(true); closePasswordModal(); } else { showNotification('Incorrect password', 'error'); } }); }

        const techForm = document.getElementById('tech-form');
        if (techForm) { techForm.addEventListener('submit', function(e) { e.preventDefault(); const name = document.getElementById('tech-name').value; const emoji = document.getElementById('tech-emoji').value; 
        
        // Перевіряємо чи не існує вже така технологія
        const existingTech = technologies.find(tech => tech.name.toLowerCase() === name.toLowerCase());
        if (existingTech) {
            showNotification('❌ Така технологія вже існує!', 'error');
            return;
        }
        
        technologies.push({ name, emoji }); saveData(); renderTechnologies(); closeTechModal(); showNotification('Technology added successfully', 'success'); }); }

        const portfolioForm = document.getElementById('portfolio-form');
        if (portfolioForm) {
            portfolioForm.addEventListener('submit', async function(e) {
                e.preventDefault();
                try {
                    const category = document.getElementById('portfolio-category').value;
                    const mediaType = document.getElementById('portfolio-media-type').value;
                    const urlInput = document.getElementById('portfolio-url').value;
                    const fileInput = document.getElementById('portfolio-file');
                    let finalUrl = urlInput;
                    if (fileInput.files && fileInput.files[0]) {
                        const file = fileInput.files[0];
                        if (file.size > 50 * 1024 * 1024) { showNotification('❌ Файл занадто великий. Максимум 50MB.', 'error'); return; }
                        finalUrl = await uploadFileToAPI(file, category);
                    } else if (!urlInput) { showNotification('❌ Введіть URL або виберіть файл', 'error'); return; }
                    // Перевіряємо чи не існує вже такий елемент
                    const existingItem = portfolioItems.find(item => 
                        item.url === finalUrl && 
                        item.category === category && 
                        item.mediaType === mediaType
                    );
                    
                    if (existingItem) {
                        showNotification('❌ Такий елемент вже існує в портфоліо!', 'error');
                        return;
                    }
                    
                    // Створюємо ГАРАНТОВАНО унікальну дату
                    let uniqueDate = new Date().toISOString();
                    
                    // Перевіряємо чи немає елементів з такою ж датою
                    while (portfolioItems.some(item => item.uploadedAt === uniqueDate)) {
                        // Додаємо 1 мілісекунду якщо дата вже існує
                        const date = new Date(uniqueDate);
                        date.setMilliseconds(date.getMilliseconds() + 1);
                        uniqueDate = date.toISOString();
                        console.log('⚠️ Date collision detected, using:', uniqueDate);
                    }
                    
                    // Створюємо новий елемент з гарантовано унікальною датою
                    const newItem = {
                        category,
                        mediaType,
                        url: finalUrl,
                        uploadedAt: uniqueDate,
                        isUploaded: !!fileInput.files[0]
                    };
                    
                    console.log('🆕 Adding new portfolio item:', {
                        category: newItem.category,
                        mediaType: newItem.mediaType,
                        url: newItem.url.substring(0, 50) + '...',
                        uploadedAt: newItem.uploadedAt
                    });
                    
                    // Додаємо новий елемент НА ПОЧАТОК масиву
                    portfolioItems.unshift(newItem);
                    
                    console.log('📊 Portfolio now has', portfolioItems.length, 'items');
                    console.log('🔄 First 3 items:');
                    portfolioItems.slice(0, 3).forEach((item, index) => {
                        console.log(`  [${index}]:`, item.url.substring(0, 30) + '...');
                    });
                    await saveData();
                    sortedOnce = false; // Скидаємо флаг, щоб пересортувати з новим елементом
                    renderPortfolio(true); // Повне перезавантаження для показу нового елемента
                    closePortfolioModal();
                    showNotification('✅ Портфоліо додано успішно!', 'success');
                } catch (error) {
                    console.error('Error adding portfolio item:', error);
                    showNotification('❌ Помилка додавання портфоліо', 'error');
                }
            });
        }

        const contactFormModal = document.getElementById('contact-form-modal');
        if (contactFormModal) { contactFormModal.addEventListener('submit', function(e) { e.preventDefault(); const platform = document.getElementById('contact-platform').value; const label = document.getElementById('contact-label').value; const url = document.getElementById('contact-url').value; const icon = getContactIcon(platform); 
        
        // Перевіряємо чи не існує вже такий контакт
        const existingContact = contacts.find(contact => 
            contact.platform === platform || contact.url === url
        );
        if (existingContact) {
            showNotification('❌ Контакт для цієї платформи або з таким URL вже існує!', 'error');
            return;
        }
        
        contacts.push({ platform, label, url, icon }); saveData(); renderContacts(); closeContactModal(); showNotification('Contact added successfully', 'success'); }); }

        function filterPortfolio() { 
            currentlyShown = 0; 
            sortedOnce = false; // Скидаємо флаг при зміні фільтрів
            updateCategoryInfo();
            updateMediaTypeFilter();
            renderPortfolio(true); 
        }
        
        function updateCategoryInfo() {
            const categoryFilter = document.querySelector('.portfolio-filter.active')?.dataset.filter || 'all';
            const categoryInfo = document.getElementById('category-info');
            
            if (categoryFilter === 'all') {
                categoryInfo.innerHTML = '';
                return;
            }
            
            // Іконки та назви для кожної категорії
            const categoryIcons = {
                'avatars': '👤',
                'image-generation': '🎨',
                'virtual-shoots': '📸',
                'ecommerce': '🛒',
                'video-creation': '🎬'
            };
            
            const categoryTitles = {
                uk: {
                    'avatars': 'AI Аватари',
                    'image-generation': 'Генерація зображень',
                    'virtual-shoots': 'Віртуальні фотосесії',
                    'ecommerce': 'E-commerce',
                    'video-creation': 'Генерація відео'
                },
                en: {
                    'avatars': 'AI Avatars',
                    'image-generation': 'Image Generation',
                    'virtual-shoots': 'Virtual Shoots',
                    'ecommerce': 'E-commerce',
                    'video-creation': 'Video Generation'
                }
            };
            
            const descriptions = {
                uk: {
                    'avatars': 'Створюю реалістичних AI-ведучих та персонажів для вашого бізнесу. Вони ідеально підходять для навчальних відео, презентацій та рекламних кампаній у соцмережах. Ваш цифровий представник ніколи не втомлюється, не хворіє і готовий працювати 24/7, заощаджуючи ваш бюджет на зйомках та акторах.',
                    'image-generation': 'Перетворюю ваші найсміливіші ідеї на унікальні зображення. Потрібен кіт-космонавт у стилі Ван Гога чи фотореалістичний портрет неіснуючої людини? Я створю для вас будь-який арт: від ілюстрацій для сайту та соцмереж до складних концепт-артів для ігор та книг.',
                    'virtual-shoots': 'Створіть нескінченну кількість професійних фотографій для себе чи свого експерта без необхідності залишати дім. На основі кількох ваших знімків я навчаю персональну AI-модель, яка може згенерувати вас у будь-якому образі, стилі одягу та локації — від ділового портрета до фото з відпустки на Балі.',
                    'ecommerce': 'Професійні рекламні матеріали для вашого бренду "під ключ". Створюю як фотореалістичні зображення ваших товарів у будь-якому оточенні, так і динамічні відеокреативи для соцмереж та промо-кампаній. Покажіть ваш продукт на моделях, в екзотичних локаціях чи в дії — без залучення знімальної групи та фотостудії.',
                    'video-creation': 'Втілюю будь-які творчі відео-ідеї. Це може бути унікальне відео-привітання для близької людини, анімація вигаданих персонажів для вашого блогу чи каналу, або просто красиве, атмосферне відео на будь-яку тему — від космосу до фентезі. Ваша фантазія — єдине обмеження.'
                },
                en: {
                    'avatars': 'I create realistic AI hosts and characters for your business. They are perfect for educational videos, presentations and advertising campaigns on social media. Your digital representative never gets tired, doesn\'t get sick and is ready to work 24/7, saving your budget on filming and actors.',
                    'image-generation': 'I turn your wildest ideas into unique images. Need a space cat in Van Gogh style or a photorealistic portrait of a non-existent person? I will create any art for you: from illustrations for websites and social media to complex concept art for games and books.',
                    'virtual-shoots': 'Create an endless number of professional photos for yourself or your expert without having to leave home. Based on a few of your shots, I train a personal AI model that can generate you in any look, clothing style and location - from a business portrait to vacation photos in Bali.',
                    'ecommerce': 'Professional advertising materials for your brand "turnkey". I create both photorealistic images of your products in any environment, and dynamic video creatives for social media and promo campaigns. Show your product on models, in exotic locations or in action - without involving a film crew and photo studio.',
                    'video-creation': 'I bring any creative video ideas to life. It can be a unique video greeting for a loved one, animation of fictional characters for your blog or channel, or just a beautiful, atmospheric video on any topic - from space to fantasy. Your imagination is the only limit.'
                }
            };
            
            const icon = categoryIcons[categoryFilter];
            const title = categoryTitles[currentLang]?.[categoryFilter];
            const description = descriptions[currentLang]?.[categoryFilter];
            
            if (description && title && icon) {
                // Градієнти для різних категорій
                const categoryGradients = {
                    'avatars': 'from-blue-500/20 to-purple-500/20',
                    'image-generation': 'from-purple-500/20 to-pink-500/20',
                    'virtual-shoots': 'from-pink-500/20 to-rose-500/20',
                    'ecommerce': 'from-indigo-500/20 to-blue-500/20',
                    'video-creation': 'from-orange-500/20 to-red-500/20'
                };
                
                const categoryIconGradients = {
                    'avatars': 'from-blue-500 to-purple-600',
                    'image-generation': 'from-purple-500 to-pink-600',
                    'virtual-shoots': 'from-pink-500 to-rose-600',
                    'ecommerce': 'from-indigo-500 to-blue-600',
                    'video-creation': 'from-orange-500 to-red-600'
                };
                
                const gradient = categoryGradients[categoryFilter] || 'from-purple-500/20 to-pink-500/20';
                const iconGradient = categoryIconGradients[categoryFilter] || 'from-purple-500 to-pink-600';
                
                categoryInfo.innerHTML = `
                    <div class="epic-card p-8 rounded-3xl max-w-4xl mx-auto relative group overflow-hidden transform transition-all duration-500 hover:scale-[1.02]">
                        <!-- Фоновий градієнт при hover -->
                        <div class="absolute inset-0 bg-gradient-to-br ${gradient} opacity-0 group-hover:opacity-100 transition-all duration-500"></div>
                        
                        <!-- Контент -->
                        <div class="relative z-10">
                            <!-- Заголовок з іконкою -->
                            <div class="flex items-center justify-center mb-6">
                                <div class="w-16 h-16 bg-gradient-to-br ${iconGradient} rounded-2xl flex items-center justify-center mr-4 glow-box group-hover:scale-110 transition-transform duration-500">
                                    <span class="text-3xl">${icon}</span>
                                </div>
                                <h3 class="text-2xl md:text-3xl font-bold text-white group-hover:text-cyan-300 transition-colors duration-300">
                                    ${title}
                                </h3>
                            </div>
                            
                            <!-- Опис -->
                            <p class="text-lg md:text-xl text-gray-300 leading-relaxed text-center group-hover:text-gray-200 transition-colors duration-300">
                                ${description}
                            </p>
                        </div>
                        
                        <!-- Декоративні елементи -->
                        <div class="absolute top-4 right-4 w-2 h-2 bg-purple-400 rounded-full opacity-60 animate-pulse"></div>
                        <div class="absolute bottom-4 left-4 w-3 h-3 bg-pink-400 rounded-full opacity-40 animate-ping"></div>
                    </div>
                `;
            }
        }
        
        function updateMediaTypeFilter() {
            const categoryFilter = document.querySelector('.portfolio-filter.active')?.dataset.filter || 'all';
            const mediaTypeFilter = document.getElementById('media-type-filter');
            
            // Показуємо фільтр тільки для категорій з фото та відео
            if (categoryFilter === 'avatars' || categoryFilter === 'ecommerce') {
                mediaTypeFilter.style.display = 'flex';
            } else {
                mediaTypeFilter.style.display = 'none';
            }
        }

        document.querySelectorAll('.portfolio-filter').forEach(button => {
            button.addEventListener('click', function() {
                document.querySelectorAll('.portfolio-filter').forEach(btn => {
                    btn.classList.remove('active', 'bg-gradient-to-r', 'from-purple-500', 'to-pink-500', 'text-white');
                    btn.classList.add('bg-gray-800', 'text-gray-300', 'border-gray-600');
                });
                this.classList.add('active', 'bg-gradient-to-r', 'from-purple-500', 'to-pink-500', 'text-white');
                this.classList.remove('bg-gray-800', 'text-gray-300', 'border-gray-600');
                filterPortfolio();
            });
        });
        
        // Додаємо обробники для чекбоксів медіа-типів
        const showPhotosCheckbox = document.getElementById('show-photos');
        const showVideosCheckbox = document.getElementById('show-videos');
        
        if (showPhotosCheckbox) {
            showPhotosCheckbox.addEventListener('change', filterPortfolio);
        }
        
        if (showVideosCheckbox) {
            showVideosCheckbox.addEventListener('change', filterPortfolio);
        }

        // Видалено старий categorySelect обробник, оскільки тепер використовуємо кнопки замість dropdown

        const addTechBtn = document.getElementById('add-technology-btn');
        if (addTechBtn) { addTechBtn.addEventListener('click', openTechModal); }

        const clearPortfolioBtn = document.getElementById('clear-portfolio-btn');
        if (clearPortfolioBtn) { clearPortfolioBtn.addEventListener('click', function() { if (confirm('Are you sure you want to clear all portfolio items? This will delete everything from Google Sheets!')) { portfolioItems = []; saveData(); renderPortfolio(); showNotification('Portfolio cleared from Google Sheets', 'success'); } }); }

        const contactPlatform = document.getElementById('contact-platform');
        if (contactPlatform) {
            contactPlatform.addEventListener('change', function() {
                const platform = this.value;
                const urlField = document.getElementById('contact-url');
                const labelField = document.getElementById('contact-label');
                if (urlField && labelField) {
                    urlField.placeholder = getUrlPlaceholder(platform);
                    labelField.placeholder = getLabelPlaceholder(platform);
                }
            });
        }

        function getUrlPlaceholder(platform) {
            const examples = { email: 'your.email@gmail.com', telegram: 'https://t.me/username', instagram: 'https://instagram.com/username', tiktok: 'https://tiktok.com/@username', linkedin: 'https://linkedin.com/in/username', youtube: 'https://youtube.com/@username', twitter: 'https://twitter.com/username', whatsapp: 'https://wa.me/1234567890', facebook: 'https://facebook.com/username', discord: 'https://discord.gg/invite', phone: '+1234567890', website: 'https://yourwebsite.com' };
            return examples[platform] || 'https://example.com';
        }

        function getLabelPlaceholder(platform) {
            const examples = { email: 'your.email@gmail.com', telegram: '@username', instagram: '@username', tiktok: '@username', linkedin: 'Your Name', youtube: '@channelname', twitter: '@username', whatsapp: '+1234567890', facebook: 'Your Name', discord: 'Server Name', phone: '+1234567890', website: 'Website Name' };
            return examples[platform] || 'Label';
        }

        function initializeLoadMoreButton() {
            const loadMoreButton = document.getElementById('load-more-btn');
            if (loadMoreButton) {
                loadMoreButton.addEventListener('click', function() {
                    this.disabled = true;
                    const buttonContentSpan = this.querySelector('span.relative.z-10');
                    if (buttonContentSpan) {
                         const loadingText = currentLang === 'uk' ? 'Завантажую...' : 'Loading...';
                         buttonContentSpan.innerHTML = `<i class="fas fa-spinner fa-spin mr-3"></i>${loadingText}`;
                    }
                    setTimeout(() => {
                        renderPortfolio(false);
                        this.disabled = false;
                        if(buttonContentSpan) {
                            const textKey = 'load-more-portfolio';
                            const buttonText = (translations[currentLang] && translations[currentLang][textKey]) || 'Load More';
                            buttonContentSpan.innerHTML = `<i class="fas fa-images mr-3"></i><span data-translate="${textKey}">${buttonText}</span><span id="load-more-count" class="ml-2 opacity-75"></span>`;
                        }
                        updateLoadMoreButton();
                    }, 500);
                });
            }
        }

        document.querySelectorAll('.modal').forEach(modal => { modal.addEventListener('click', function(e) { if (e.target === this) { this.classList.remove('active'); } }); });

        document.addEventListener('click', function(e) {
            const adminPanel = document.getElementById('admin-panel');
            const adminToggle = document.getElementById('admin-toggle');
            if (adminPanel && adminToggle && !adminPanel.contains(e.target) && !adminToggle.contains(e.target)) {
                adminPanel.style.display = 'none';
            }
        });
        if (adminToggle) { adminToggle.addEventListener('click', function() { const adminPanel = document.getElementById('admin-panel'); if (adminPanel) { adminPanel.style.display = adminPanel.style.display === 'block' ? 'none' : 'block'; } }); }

        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) { target.scrollIntoView({ behavior: 'smooth', block: 'start' }); }
            });
        });
        
        const observerOptions = { threshold: 0.1, rootMargin: '0px 0px -50px 0px' };
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => { if (entry.isIntersecting) { entry.target.style.opacity = '1'; entry.target.style.transform = 'translateY(0)'; } });
        }, observerOptions);
        document.querySelectorAll('.service-card, section').forEach(el => { el.style.opacity = '0'; el.style.transform = 'translateY(30px)'; el.style.transition = 'opacity 0.6s ease, transform 0.6s ease'; observer.observe(el); });

        const mobileMenuButton = document.getElementById('mobile-menu-button');
        if (mobileMenuButton) { mobileMenuButton.addEventListener('click', function() { const mobileMenu = document.getElementById('mobile-menu'); if (mobileMenu) { const isHidden = mobileMenu.classList.contains('hidden'); if (isHidden) { mobileMenu.classList.remove('hidden'); const icon = this.querySelector('i'); if (icon) { icon.classList.remove('fa-bars'); icon.classList.add('fa-times'); } } else { mobileMenu.classList.add('hidden'); const icon = this.querySelector('i'); if (icon) { icon.classList.add('fa-bars'); icon.classList.remove('fa-times'); } } } }); }

        document.querySelectorAll('.mobile-nav-link').forEach(link => {
            link.addEventListener('click', function() {
                const mobileMenu = document.getElementById('mobile-menu');
                const menuButton = document.getElementById('mobile-menu-button');
                if (mobileMenu) { mobileMenu.classList.add('hidden'); }
                if (menuButton) { const icon = menuButton.querySelector('i'); if (icon) { icon.classList.add('fa-bars'); icon.classList.remove('fa-times'); } }
            });
        });

        const lightboxClose = document.getElementById('lightbox-close');
        const lightboxPrev = document.getElementById('lightbox-prev');
        const lightboxNext = document.getElementById('lightbox-next');
        const lightbox = document.getElementById('lightbox');
        if (lightboxClose) { lightboxClose.addEventListener('click', closeLightbox); }
        if (lightboxPrev) { lightboxPrev.addEventListener('click', prevLightboxItem); }
        if (lightboxNext) { lightboxNext.addEventListener('click', nextLightboxItem); }
        if (lightbox) { lightbox.addEventListener('click', function(e) { if (e.target === this) { closeLightbox(); } }); }

        document.addEventListener('keydown', function(e) {
            if (lightbox && lightbox.classList.contains('active')) {
                switch(e.key) {
                    case 'Escape': closeLightbox(); break;
                    case 'ArrowLeft': prevLightboxItem(); break;
                    case 'ArrowRight': nextLightboxItem(); break;
                }
            }
        });
        
        let touchStartX = null;
        let touchStartY = null;
        if (lightbox) {
            lightbox.addEventListener('touchstart', function(e) { touchStartX = e.touches[0].clientX; touchStartY = e.touches[0].clientY; });
            lightbox.addEventListener('touchend', function(e) {
                if (!touchStartX || !touchStartY) return;
                const touchEndX = e.changedTouches[0].clientX;
                const touchEndY = e.changedTouches[0].clientY;
                const deltaX = touchStartX - touchEndX;
                const deltaY = touchStartY - touchEndY;
                if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > 50) { if (deltaX > 0) { nextLightboxItem(); } else { prevLightboxItem(); } }
                touchStartX = null;
                touchStartY = null;
            });
        }
        
        window.testDataLoad = async function() {
            try {
                showNotification('🔄 Тестую завантаження даних...', 'success');
                console.log('🧪 STARTING DATA LOAD TEST...');
                const data = await loadDataFromAPI();
                console.log('📊 Test result:', data);
                renderTechnologies();
                renderPortfolio();
                renderContacts();
                const message = `✅ Тест завершено! Portfolio: ${portfolioItems.length}, Tech: ${technologies.length}, Contacts: ${contacts.length}`;
                console.log(message);
                showNotification(message, 'success');
            } catch (error) {
                console.error('❌ Test failed:', error);
                showNotification('❌ Тест не пройшов: ' + error.message, 'error');
            }
        }
        
        window.removeDuplicatesFromPortfolio = async function() {
            try {
                const hadDuplicates = removeDuplicates();
                if (hadDuplicates) {
                    await saveData();
                    renderPortfolio(true);
                } else {
                    showNotification('Дублікати не знайдені', 'success');
                }
            } catch (error) {
                console.error('❌ Error removing duplicates:', error);
                showNotification('Помилка видалення дублікатів', 'error');
            }
        }
        
        // Функція для виправлення існуючих дублікатів дат
        window.fixDateDuplicates = async function() {
            try {
                console.log('🔧 Fixing date duplicates...');
                const datesSeen = new Set();
                let fixed = 0;
                
                portfolioItems.forEach((item, index) => {
                    if (datesSeen.has(item.uploadedAt)) {
                        // Генеруємо нову унікальну дату
                        let newDate = new Date(item.uploadedAt);
                        newDate.setMilliseconds(newDate.getMilliseconds() + fixed + 1);
                        
                        while (datesSeen.has(newDate.toISOString())) {
                            newDate.setMilliseconds(newDate.getMilliseconds() + 1);
                        }
                        
                        console.log(`🔧 Fixed date for item [${index}]:`, item.url?.substring(0, 30), 
                                  'from:', item.uploadedAt, 'to:', newDate.toISOString());
                        
                        item.uploadedAt = newDate.toISOString();
                        fixed++;
                    }
                    datesSeen.add(item.uploadedAt);
                });
                
                if (fixed > 0) {
                    console.log(`✅ Fixed ${fixed} date duplicates`);
                    showNotification(`Виправлено ${fixed} дублікатів дат`, 'success');
                    await saveData();
                    renderPortfolio(true);
                } else {
                    showNotification('Дублікати дат не знайдені', 'success');
                }
            } catch (error) {
                console.error('❌ Error fixing date duplicates:', error);
                showNotification('Помилка виправлення дублікатів дат', 'error');
            }
        }

        // Додаємо глобальну функцію для діагностики дублікатів
        // Діагностична функція для перевірки проблем з рендерингом
        window.debugPortfolioRendering = function() {
            console.log('🔍 DEBUG: Portfolio Rendering Analysis');
            console.log('='.repeat(50));
            
            // 1. Перевіряємо дані
            console.log('📊 Data Analysis:');
            console.log('- portfolioItems.length:', portfolioItems.length);
            console.log('- filteredItems.length:', filteredItems.length);
            console.log('- currentlyShown:', currentlyShown);
            console.log('- sortedOnce:', sortedOnce);
            
            // 2. Перевіряємо DOM елементи
            console.log('\n🏗️ DOM Analysis:');
            const grid = document.getElementById('portfolio-grid');
            const domItems = grid ? grid.querySelectorAll('.portfolio-item') : [];
            console.log('- DOM portfolio items count:', domItems.length);
            console.log('- Grid innerHTML length:', grid ? grid.innerHTML.length : 'Grid not found');
            
            // 3. Перевіряємо фільтри
            console.log('\n🔧 Filter Analysis:');
            const activeFilter = document.querySelector('.portfolio-filter.active');
            console.log('- Active filter:', activeFilter ? activeFilter.dataset.filter : 'No active filter');
            console.log('- Show photos:', document.getElementById('show-photos')?.checked);
            console.log('- Show videos:', document.getElementById('show-videos')?.checked);
            
            // 4. Перевіряємо можливі дублі в DOM
            console.log('\n🔄 DOM Duplication Check:');
            const urlsInDOM = [];
            const dataIndexCounts = {};
            
            domItems.forEach((item, index) => {
                const img = item.querySelector('img');
                const video = item.querySelector('video');
                const iframe = item.querySelector('iframe');
                let url = 'unknown';
                if (img) url = img.src;
                else if (video) url = video.querySelector('source')?.src || 'video';
                else if (iframe) url = iframe.src;
                
                const dataIndex = item.dataset.index;
                
                urlsInDOM.push({ 
                    domIndex: index, 
                    dataIndex: dataIndex,
                    itemId: item.dataset.itemId,
                    url: url.substring(0, 50) + '...' 
                });
                
                // Рахуємо дублі по data-index
                dataIndexCounts[dataIndex] = (dataIndexCounts[dataIndex] || 0) + 1;
            });
            
            const urlCounts = {};
            urlsInDOM.forEach(item => {
                urlCounts[item.url] = (urlCounts[item.url] || 0) + 1;
            });
            
            const domDuplicates = Object.entries(urlCounts).filter(([url, count]) => count > 1);
            const indexDuplicates = Object.entries(dataIndexCounts).filter(([index, count]) => count > 1);
            
            console.log('- DOM URL duplicates found:', domDuplicates.length);
            domDuplicates.forEach(([url, count]) => {
                console.log(`  ❌ URL ${url} appears ${count} times`);
            });
            
            console.log('- DOM Index duplicates found:', indexDuplicates.length);
            indexDuplicates.forEach(([index, count]) => {
                console.log(`  ❌ Index ${index} appears ${count} times`);
            });
            
            // 5. Детальний аналіз індексів
            console.log('\n📍 Detailed Index Analysis:');
            urlsInDOM.forEach((item, domIndex) => {
                const isDuplicateIndex = dataIndexCounts[item.dataIndex] > 1 ? ' 🔴 DUPLICATE!' : '';
                console.log(`DOM[${domIndex}] -> data-index: ${item.dataIndex}${isDuplicateIndex}, itemId: ${item.itemId}`);
            });
            
            // 6. Перевіряємо порядок filteredItems vs portfolioItems
            console.log('\n🔄 Order Analysis:');
            console.log('First 5 filteredItems URLs:');
            filteredItems.slice(0, 5).forEach((item, index) => {
                console.log(`  Filtered[${index}]: ${item.url.substring(0, 30)}...`);
            });
            console.log('First 5 portfolioItems URLs:');
            portfolioItems.slice(0, 5).forEach((item, index) => {
                console.log(`  Portfolio[${index}]: ${item.url.substring(0, 30)}...`);
            });
            
            // 7. Аналіз дублікатів у даних
            console.log('\n🔍 Data Duplicates Analysis:');
            const dataUrlCounts = {};
            portfolioItems.forEach((item, index) => {
                const key = item.url.substring(0, 50);
                if (!dataUrlCounts[key]) {
                    dataUrlCounts[key] = [];
                }
                dataUrlCounts[key].push(index);
            });
            
            const dataDuplicates = Object.entries(dataUrlCounts).filter(([url, indices]) => indices.length > 1);
            console.log('- Data duplicates found:', dataDuplicates.length);
            dataDuplicates.forEach(([url, indices]) => {
                console.log(`  📊 Data URL ${url}... at indices: [${indices.join(', ')}]`);
            });
            
            return {
                dataItems: portfolioItems.length,
                filteredItems: filteredItems.length,
                domItems: domItems.length,
                domDuplicates: domDuplicates.length,
                indexDuplicates: indexDuplicates.length,
                dataDuplicates: dataDuplicates.length,
                currentlyShown: currentlyShown,
                sortedOnce: sortedOnce
            };
        }

        window.checkDuplicates = function() {
            console.log('📊 Portfolio Items Analysis:');
            console.log('Total items:', portfolioItems.length);

            // Перевіримо дублювання по URL
            const urlCounts = {};
            portfolioItems.forEach((item, index) => {
                const url = item.url;
                if (!urlCounts[url]) {
                    urlCounts[url] = [];
                }
                urlCounts[url].push(index);
            });

            const duplicates = Object.entries(urlCounts).filter(([url, indices]) => indices.length > 1);

            console.log('🔍 Duplicate URLs found:', duplicates.length);
            duplicates.forEach(([url, indices]) => {
                console.log(`❌ Duplicate URL: ${url}`);
                console.log(`   Found at indices: ${indices.join(', ')}`);
                indices.forEach(index => {
                    console.log(`   Item ${index}:`, portfolioItems[index]);
                });
            });

            // Перевіримо дублювання по комбінації category + url
            const categoryUrlCombos = {};
            portfolioItems.forEach((item, index) => {
                const combo = `${item.category}_${item.url}`;
                if (!categoryUrlCombos[combo]) {
                    categoryUrlCombos[combo] = [];
                }
                categoryUrlCombos[combo].push(index);
            });

            const categoryDuplicates = Object.entries(categoryUrlCombos).filter(([combo, indices]) => indices.length > 1);
            console.log('🔍 Duplicate category+URL combinations:', categoryDuplicates.length);

            // Перевіримо структуру масиву
            console.log('📋 First 3 items structure:');
            portfolioItems.slice(0, 3).forEach((item, index) => {
                console.log(`Item ${index}:`, {
                    category: item.category,
                    mediaType: item.mediaType,
                    url: item.url ? item.url.substring(0, 50) + '...' : 'No URL',
                    uploadedAt: item.uploadedAt
                });
            });

            return {
                totalItems: portfolioItems.length,
                duplicateUrls: duplicates.length,
                duplicateCombo: categoryDuplicates.length
            };
        }

        console.log('🚀 Starting Andrii AI Portfolio...');
        updateLanguage(currentLang);
        loadDataFromAPI().then((data) => {
            console.log('✅ Data loaded successfully');
            renderTechnologies();
            updateCategoryInfo(); // Ініціалізуємо опис категорії
            updateMediaTypeFilter(); // Ініціалізуємо фільтр медіа-типів
            renderPortfolio(true);
            renderContacts();
            setTimeout(() => initializeLoadMoreButton(), 100);
            console.log('🎉 Portfolio loaded!');
        }).catch((error) => {
            console.error('⚠️ Using offline mode:', error);
            renderTechnologies();
            updateCategoryInfo();
            updateMediaTypeFilter();
            renderPortfolio(true);
            renderContacts();
            setTimeout(() => initializeLoadMoreButton(), 100);
            console.log('💻 Portfolio loaded in offline mode');
        });
    </script>
</body>
</html>
